<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-04-23 Sat 09:54 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=1024, initial-scale=1" />
<title>PhilaJ: Philatelic Tools For ImageJ</title>
<meta name="author" content="Mitch Richling" />
<meta name="description" content="Philatelic Tools For ImageJ" />
<meta name="keywords" content="Philatelic stamps postage ImageJ Fiji Macro Image Processing Image Analysis" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
</style>
<style>body { width: 95%; margin: 2% auto; font-size: 18px; line-height: 1.4em; font-family: Georgia, serif; color: black; background-color: white; }</style>
<style>body { min-width: 500px; max-width: 1024px; }</style>
<style>h1,h2,h3,h4,h5,h6 { color: #A5573E; line-height: 1em; font-family: Helvetica, sans-serif; }</style>
<style>h1,h2,h3 { line-height: 1.4em; }</style>
<style>h1.title { font-size: 3em; }</style>
<style>h4,h5,h6 { font-size: 1em; }</style>
<style>.org-src-container { border: 1px solid #ccc; box-shadow: 3px 3px 3px #eee; font-family: Lucida Console, monospace; font-size: 80%; margin: 0px; padding: 0px 0px; position: relative; }</style>
<style>.org-src-container>pre { line-height: 1.2em; padding-top: 1.5em; margin: 0.5em; background-color: #404040; color: white; overflow: auto; }</style>
<style>.org-src-container>pre:before { display: block; position: absolute; background-color: #b3b3b3; top: 0; right: 0; padding: 0 0.2em 0 0.4em; border-bottom-left-radius: 8px; border: 0; color: white; font-size: 100%; font-family: Helvetica, sans-serif;}</style>
<style>pre.example { white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -o-pre-wrap; font-family: Lucida Console, monospace; font-size: 80%; background: #404040; color: white; display: block; padding: 0em; border: 2px solid black; }</style>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="https://github.com/richmit/imagej"> UP </a>
 |
 <a accesskey="H" href="https://www.mitchr.me/"> HOME </a>
</div><div id="content" class="content">
<h1 class="title">PhilaJ: Philatelic Tools For ImageJ</h1>
<table border="2 solid #ccc" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" align="center">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right"><b>Author:</b></td>
<td class="org-left"><i>Mitch Richling</i></td>
</tr>

<tr>
<td class="org-right"><b>Updated:</b></td>
<td class="org-left"><i>2022-04-23 09:54:13</i></td>
</tr>

<tr>
<td class="org-right"><b>Generated:</b></td>
<td class="org-left"><i>2022-04-23 09:54:16</i></td>
</tr>
</tbody>
</table>
<p align="center">
Copyright 2022 Mitch Richling. All rights reserved.
</p>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org022e534">1. Introduction</a></li>
<li><a href="#orgc81fbba">2. Some PhilaJ Features</a>
<ul>
<li><a href="#org7628d12">2.1. Future Features</a></li>
</ul>
</li>
<li><a href="#org4c512de">3. Learning ImageJ</a>
<ul>
<li><a href="#orgcdf8aa0">3.1. ImageJ is not Photoshop!</a></li>
<li><a href="#orgfcd7755">3.2. ImageJ &amp; ROIs</a></li>
<li><a href="#orgd707baa">3.3. Overlays</a></li>
<li><a href="#org9bf0f85">3.4. Learning how to use ImageJ</a></li>
</ul>
</li>
<li><a href="#orgd68cf80">4. Using PhilaJ</a>
<ul>
<li><a href="#org737faf8">4.1. Install Fiji</a></li>
<li><a href="#orgabc23ab">4.2. Installing PhilaJ</a>
<ul>
<li><a href="#org82a95b7">4.2.1. The PhilaJ Package</a></li>
<li><a href="#orgeb1683e">4.2.2. Specialized Perforation Gauges</a></li>
<li><a href="#org4560db0">4.2.3. Settings</a></li>
</ul>
</li>
<li><a href="#org3c949cc">4.3. Activate PhilaJ</a></li>
<li><a href="#keybindings">4.4. Keyboard short-cuts</a></li>
<li><a href="#tool-set-buttons">4.5. Tool-set Buttons</a>
<ul>
<li><a href="#orga413148">4.5.1. Overlay Menu (images &amp; annotations drawn over the stamp image in a nondestructive way)</a></li>
<li><a href="#tool-set-buttons-interact">4.5.2. Overlay Interaction tool</a></li>
<li><a href="#org23dc5f3">4.5.3. Image Scale Menu (so we can measure things like distances &amp; perforations)</a></li>
<li><a href="#org8e0792e">4.5.4. Acquiring &amp; Saving Images &amp; Data Menu</a></li>
<li><a href="#orga5ae52e">4.5.5. Everything Else Menu</a></li>
</ul>
</li>
<li><a href="#orgce39319">4.6. PhilaJ Tools</a>
<ul>
<li><a href="#dynamic-perf-gauge">4.6.1. Dynamic perforation gauge</a></li>
<li><a href="#reuse-dynamic-perf-roi">4.6.2. Reusing Dynamic Perforation Gauge ROIs</a></li>
<li><a href="#static-perf-gauge">4.6.3. Static perforation gauges</a></li>
<li><a href="#custom-spec-gauge">4.6.4. User Installable Customized Specialist Gauges</a></li>
<li><a href="#centering-measurements">4.6.5. Measuring Design &amp; Margins</a>
<ul>
<li><a href="#org5229236">4.6.5.1. Centering Metrics</a></li>
<li><a href="#org342aff5">4.6.5.2. ROI Details</a></li>
</ul>
</li>
<li><a href="#coord-tool">4.6.6. Coordinate Tool</a></li>
<li><a href="#pos-finder">4.6.7. Position Finder</a></li>
<li><a href="#measure-edges">4.6.8. Measuring Edges</a></li>
<li><a href="#grill-tool">4.6.9. Grill Tool</a></li>
<li><a href="#sheet-tools">4.6.10. Working With Multiples &amp; Sheets</a></li>
<li><a href="#phil-rotate">4.6.11. Image Rotation</a></li>
<li><a href="#sub-image">4.6.12. Making Images From Selections</a></li>
<li><a href="#overlay-measure">4.6.13. Overlay/ROI Measure</a></li>
<li><a href="#measure-offset">4.6.14. Measuring ROI Offsets</a></li>
<li><a href="#load-save-magic">4.6.15. PhilaJ Image Load &amp; Save</a></li>
<li><a href="#roi-sidecars">4.6.16. ROI Sidecars</a></li>
<li><a href="#note-sidecars">4.6.17. Note Sidecars</a></li>
<li><a href="#set-scale-convert">4.6.18. Convert image scale units to mm</a></li>
<li><a href="#scale-image-scale">4.6.19. Image Resize To Scale</a></li>
<li><a href="#scale-roi">4.6.20. Scale ROIs</a></li>
<li><a href="#scale-alt">4.6.21. Alternate interfaces to the ImageJ set scale command</a></li>
<li><a href="#set-scale-dpi">4.6.22. Set scale via DPI</a></li>
<li><a href="#set-scale-filename">4.6.23. Set scale from DPI file name</a></li>
<li><a href="#phil-data">4.6.24. Philatelic Data</a></li>
<li><a href="#phil-units">4.6.25. Philatelic Unit Conversions</a></li>
<li><a href="#scale-report">4.6.26. Scale Report</a></li>
<li><a href="#bulk-processing">4.6.27. Bulk Processing Images</a></li>
<li><a href="#cleaning-up-windows-n-files">4.6.28. Cleanup Windows and Files</a></li>
<li><a href="#roi-name-tools">4.6.29. Bulk ROI Rename</a></li>
<li><a href="#roi-cleanup">4.6.30. Cleanup The ROI Manager</a></li>
</ul>
</li>
<li><a href="#capture-and-scale">4.7. Capturing and adjusting properly scaled images</a></li>
<li><a href="#spec-gauge-list">4.8. Available Specialist gauges and presets</a></li>
<li><a href="#org4d53313">4.9. A Note About The Thirkell Position Finder</a></li>
<li><a href="#org8bf1f5e">4.10. ROIs</a>
<ul>
<li><a href="#org64ba898">4.10.1. Named ROIs</a>
<ul>
<li><a href="#orgd2267b9">4.10.1.1. Notation</a></li>
<li><a href="#roi-name-components">4.10.1.2. About ROI Name Components</a></li>
<li><a href="#org1a0a34d">4.10.1.3. Some Component Recommendations</a></li>
<li><a href="#bb-hr-roi">4.10.1.4. About "<code>HR</code>" &amp; "<code>BB</code>" ROIs</a></li>
<li><a href="#org8613c0a">4.10.1.5. How ROIs are Used</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#rpi-tools">5. RPI Tools</a>
<ul>
<li><a href="#orga2cdaf9">5.1. Activate RPI-Tools</a></li>
<li><a href="#orgaf534e5">5.2. Button Functions</a>
<ul>
<li><a href="#rpi-capture">5.2.1. Capture Image From RPI Microscope Camera</a></li>
<li><a href="#rpi-settings">5.2.2. Configure RPI Microscope Camera</a></li>
<li><a href="#rpi-preview">5.2.3. Live Video From RPI Microscope Camera (no capture)</a></li>
<li><a href="#rpi-load">5.2.4. Load Previous RPI Microscope Camera Captures</a></li>
<li><a href="#scale-rpi">5.2.5. Set Scale for Stereo Microscope Photograph</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgdae6206">6. EOF</a></li>
</ul>
</div>
</div>

<div id="outline-container-org022e534" class="outline-2">
<h2 id="org022e534"><span class="section-number-2">1.</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
PhilaJ is software to assist with philatelic image analysis. It is built on top of the popular scientific image analysis package
<a href="https://imagej.net/">ImageJ/Fiji</a>.
</p>
</div>
</div>

<div id="outline-container-orgc81fbba" class="outline-2">
<h2 id="orgc81fbba"><span class="section-number-2">2.</span> Some PhilaJ Features</h2>
<div class="outline-text-2" id="text-2">
<p>
While ImageJ is perfectly capable of philatelic image analysis out of the box, PhilaJ assists the philatelist by automating and simplifying many typical
philatelic image processing procedures.
</p>

<ul class="org-ul">
<li>Efficiently rotate and zoom images
<ul class="org-ul">
<li>A single key press can switch between 100% zoom <i>at the cursor</i> and zoom to fit.</li>
<li>Most of the time philatelists want to rotate an image so some reference line is horizontal or vertical, and that's how this tool works.  Draw a line,
hit a key, and the image is rotated to make the line horizontal.</li>
<li>A single key press to rotate an image 90 degrees</li>
</ul></li>
<li>Semi-Automated measurements
<ul class="org-ul">
<li>Stamp design centering</li>
<li>Design size</li>
<li>Paper size</li>
<li>Check coil paper edges (parallel &amp; large enough)</li>
<li>Perforations computed from linear distances</li>
<li>Measure angle difference between arbitrary edges (design, paper, perforations, etc&#x2026;)</li>
<li>Measurement results can be saved or directly imported into Excel</li>
<li>Named ROIs in the ROI manager will automatically be used if they exist for many measurements</li>
<li>Measurements create ROIs to document &amp; save results for later use</li>
</ul></li>
<li>Perforation Measurements
<ul class="org-ul">
<li>A fully dynamic perforation gauge brings perforation measurements into the digital realm.  Simultaneously and accurately measure perforations frequency and hole size and on any angle</li>
<li>Perforations may be directly, and very accurately, computed from simple distance measurements</li>
<li>Display very customizable, old school perforation gauges (Instanta &amp; Kiusalas) over the image so that perforations may be measured in the traditional manner.</li>
<li>Specialized gauges for particular stamps like the US Liberty Issues or AMG Bari Wolf Issue</li>
</ul></li>
<li>Grills
<ul class="org-ul">
<li>Display a very customizable template of US Grills over image</li>
<li>Standard grill characteristics are all pre-programmed:</li>
</ul></li>
<li>Split up an image of a sheet into a stack of individual stamps</li>
<li>Thirkell-type position finder (automatically positioned over the design ROI)</li>
<li>Millimeter Coordinate Tool (a modern, digital take on the Thirkell).</li>
<li>Tools to document plate flaws with coordinates and thumbnail images.</li>
<li>Full support for my DIY Microscope camera is included (live video, captures, measurements)</li>
<li>Sophisticated, and automatic management of physical image scales</li>
<li>Systematic use of ImageJ/Fiji ROIs across the tool</li>
</ul>
</div>

<div id="outline-container-org7628d12" class="outline-3">
<h3 id="org7628d12"><span class="section-number-3">2.1.</span> Future Features</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Some of the features listed here are very difficult to implement &#x2013; complex enough they might not even be possible.  Others are easy things I simply need to
find the time to implement.  Feel free to contact me with ideas for this list. I have no idea when, or if, I'll find the time to work on any of these, but I
have tried to sort the list from highest priority to lowest:
</p>

<ul class="org-ul">
<li>Automatic grill identification from grill boundary (Easy)</li>
<li>Reference templates for various private perforations</li>
<li>rotary vs flat press
<ul class="org-ul">
<li>Templates? (Easy)</li>
<li>Automatic measurement?  What about graphical masking with range limits? (Not Hard)</li>
</ul></li>
<li>Watermarks
<ul class="org-ul">
<li>Templates (Easy.  Hardest part is obtaining correctly scaled source images)</li>
<li>Automatic shape identification and match to DB of templates?  Start with US. (Hard)</li>
</ul></li>
<li>Postmarks
<ul class="org-ul">
<li>Templates (Hard)
<ul class="org-ul">
<li>Easy way to pull in an image from <a href="https://www.stampsx.com/ratgeber/stempel-datenbank.php">https://www.stampsx.com/ratgeber/stempel-datenbank.php</a></li>
<li>Way to categorize US post marks using the standard references</li>
<li>Way to convert reference postmark raster images into vector data</li>
</ul></li>
<li>Postmark Image Processing
<ul class="org-ul">
<li>Way to extract postmark data from image (Hard.  Some experimental results in my ImageJ GIT repository)</li>
</ul></li>
</ul></li>
<li>Plate flaws (Hard)
<ul class="org-ul">
<li>Semi-automated help for comparing images and manually marking plate flaws with ROIs
<ul class="org-ul">
<li>Help with aligning the images</li>
<li>Good way to overlay the images and dynamically adjust transparency</li>
<li>Easy way to mark flaws and create ROIs</li>
</ul></li>
<li>Fully automated analysis of an image sequence or stack to generate a "canonical stamp" &amp; identify deviations</li>
</ul></li>
<li>Fully automatic full sheet separation (Hard)
<ul class="org-ul">
<li>Identify individual stamps</li>
<li>Create stack</li>
<li>Align slices</li>
</ul></li>
<li>Automatically detect paper and design edges for measurements (Hard)
<ul class="org-ul">
<li>Many of the stamps I care about most have well defined frame lines, and this could be exploited in any algorithms I develop</li>
</ul></li>
<li>Automatically detect perforations for measurements (Hard)
<ul class="org-ul">
<li>Mostly I care about rectangular stamps only</li>
<li>It would be nice to detect the holes directly &#x2013; perhaps a multi-point, affinity-descent method to find the hole bottoms?</li>
</ul></li>
<li>Compute perforations automatically (Hard)
<ul class="org-ul">
<li>Via Fourier transform</li>
<li>Via custom line graph analysis</li>
</ul></li>
<li>Automatic grill identification from individual grill points (Hard)
<ul class="org-ul">
<li>Use up/down data provided by user to guide algorithm</li>
<li>Automatically detect horizontal vs vertical ridges</li>
<li>Ask user if point bounding box covers entire grill</li>
<li>Use Scott numbers provided by the user to guide algorithm</li>
</ul></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org4c512de" class="outline-2">
<h2 id="org4c512de"><span class="section-number-2">3.</span> Learning ImageJ</h2>
<div class="outline-text-2" id="text-3">
<p>
Because many people wishing to use PhilaJ are not already ImageJ users, this section provides some ImageJ background information and some links to learn more.
</p>
</div>

<div id="outline-container-orgcdf8aa0" class="outline-3">
<h3 id="orgcdf8aa0"><span class="section-number-3">3.1.</span> ImageJ is not Photoshop!</h3>
<div class="outline-text-3" id="text-3-1">
<p>
ImageJ is not hard to use.  In many ways it is less complex than Photoshop or GIMP.  That said, sometimes ImageJ newcomers stumble because ImageJ looks a lot
like Photoshop &amp; GIMP but it works quite differently.  The similarity really is just surface deep.  Tools like Photoshop are intended for image manipulation
with an eye toward the artistic.  Tools like ImageJ are intended for image measurement.
</p>

<p>
You <b>can</b> measure things with Photoshop.  You <b>can</b> draw with ImageJ.  You <b>can</b> drive a nail with a screwdriver.
</p>

<p>
So my advice while learning learning ImageJ is to keep in mind that it is a completely different tool than Photoshop or GIMP.  Do not expect similar behavior.
Do not expect your knowledge of Photoshop or GIMP to translate to ImageJ.  ImageJ is not harder to use than Photoshop or GIMP!  It is just a different sort of
tool &#x2013; screwdriver vs hammer.
</p>
</div>
</div>

<div id="outline-container-orgfcd7755" class="outline-3">
<h3 id="orgfcd7755"><span class="section-number-3">3.2.</span> ImageJ &amp; ROIs</h3>
<div class="outline-text-3" id="text-3-2">
<p>
The "drawing" tools on the ImageJ toolbar are not drawing tools in that they do not draw anything (i.e. they do not manipulate the image in any way).  Instead
they allow the user to identify "regions of interest" &#x2013; parts of the image we wish to measure.  For example, we might use the rectangle tool to identify the
edges of a stamp's design &#x2013; so we can measure it's size perhaps to tell if it's a rotary or flat press print.  As another example, we might use the line tool
to identify the distance required for 11 perforation holes, and use that distance to compute the stamps perforation gauge.  We might select an irregular
region of the design so we can measure the colors, and then compare them to a part of the stamp we suspect may have been fraudulently manipulated.
</p>

<p>
The closest concept in Photoshop/GIMP are <i>selections</i>, but ImageJ <i>ROIs</i> are a far more general concept.
</p>

<p>
Once again.  ImageJ is all about measuring things.  Distances, sizes, colors, etc&#x2026;
</p>
</div>
</div>

<div id="outline-container-orgd707baa" class="outline-3">
<h3 id="orgd707baa"><span class="section-number-3">3.3.</span> Overlays</h3>
<div class="outline-text-3" id="text-3-3">
<p>
Overlays are images &amp; annotations placed over the image we we analyzing.  Back in the day, scientists would place a transparent film over a photograph and
then draw on the film.  Overlays are the digital equivalent.  Overlays don't modify the image pixels at all.  The classical application of overlays in
scientific image analysis is to annotate an image.  For example, a Doctor might highlight and label the location of a bone fracture on an X-ray.  An overlay
may be dragged around over the image making it a useful tool for comparisons.  Such comparisons generally take one of two forms:
</p>
<ul class="org-ul">
<li>Looking for differences between two images</li>
<li>Seeing if an image matches some standard</li>
</ul>
<p>
The two most common philatelic applications for image comparison are:
</p>
<ul class="org-ul">
<li>Comparing too stamps looking for plate flaws &amp; faults.</li>
<li>Comparing a stamp and the image on a certificate.  i.e. is the stamp for sale is the one pictured on the cert.</li>
</ul>
<p>
The most common philatelic applications for comparison to a standard are:
</p>
<ul class="org-ul">
<li>Comparing stamp perforations to a perforation gauge (be it an Instanta-type or Kiusalas-type)</li>
<li>Comparing a grill to a grill template</li>
<li>Comparing a design to a rotary vs. flat plate template</li>
</ul>

<p>
The closest concept in Photoshop/GIMP are <i>layers</i>, but they are quite different in a few respects.  The most obvious difference is a matter of content.  An
ImageJ overlay may contain ROIs, vector graphics, and raster data (images).  In Photoshop/GIMP layers only contain raster data (images).  Another big
difference is a mater of quantity.  In Photoshop many layers normally exist in one file; however, in ImageJ you only get one.  The last big difference is in
how we use them.  In Photoshop/GIMP layers exist to be mixed together so that we may render a final image.  In ImageJ an overlay is sometimes used to create
an image (say for a scientific publication); however, overlays overlays find far more use as a tool for active analysis and measurement.
</p>
</div>
</div>

<div id="outline-container-org9bf0f85" class="outline-3">
<h3 id="org9bf0f85"><span class="section-number-3">3.4.</span> Learning how to use ImageJ</h3>
<div class="outline-text-3" id="text-3-4">
<p>
To use PhilaJ, I think the basic tutorial at <a href="https://imagej.net">imagej.net</a> is enough: <a href="https://imagej.net/learn/">https://imagej.net/learn/</a>
</p>

<p>
The <a href="https://imagej.net">imagej.net</a> site is stuffed full of great content, and is one of the best sources if you want to become an ImageJ expert.  That
said, I think the tutorial linked above is all you really need to get started with PhilaJ.
</p>
</div>
</div>
</div>

<div id="outline-container-orgd68cf80" class="outline-2">
<h2 id="orgd68cf80"><span class="section-number-2">4.</span> Using PhilaJ</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org737faf8" class="outline-3">
<h3 id="org737faf8"><span class="section-number-3">4.1.</span> Install Fiji</h3>
<div class="outline-text-3" id="text-4-1">
<p>
From this point on, this document assumes you are using the Fiji distribution of ImageJ.  If you have not yet installed it, then do so now:
<a href="https://imagej.net/software/fiji/">https://imagej.net/software/fiji/</a>
</p>

<p>
I recommend that you install it someplace in your user directory.  
</p>
</div>
</div>

<div id="outline-container-orgabc23ab" class="outline-3">
<h3 id="orgabc23ab"><span class="section-number-3">4.2.</span> Installing PhilaJ</h3>
<div class="outline-text-3" id="text-4-2">
</div>
<div id="outline-container-org82a95b7" class="outline-4">
<h4 id="org82a95b7"><span class="section-number-4">4.2.1.</span> The PhilaJ Package</h4>
<div class="outline-text-4" id="text-4-2-1">
<p>
Installing PhilaJ requires the "<code>imagej/PhilaJ-and-RPI_Tools/PhilaJ.ijm</code>" file in the PhilaJ distribution be copied into the Fiji toolsets directory.  This
directory is normally named "<code>macros/toolsets/</code>", and may be found inside the Fiji install directory.  For example, I install Fiji at
"<code>c:\Users\richmit\PF\Fiji.app</code>", and thus I copy the "<code>PhilaJ.ijm</code>" file to "<code>c:\Users\richmit\PF\Fiji.app\macros\toolsets\PhilaJ.ijm</code>".
</p>

<p>
If ImageJ was running when you copied the file, then you need to quite and restart it.
</p>
</div>
</div>

<div id="outline-container-orgeb1683e" class="outline-4">
<h4 id="orgeb1683e"><span class="section-number-4">4.2.2.</span> Specialized Perforation Gauges</h4>
<div class="outline-text-4" id="text-4-2-2">
<p>
You will also want to install some specialized perforation gauges.  Several gauges are shipped as part of the PhilaJ distribution in the
"<code>imagej/PhilaJ-and-RPI_Tools/SpecializedGauges</code>" directory.  For instructions on how to install these gauges see: <a href="#custom-spec-gauge"><code>Install New
Specialized Gauge</code></a>.
</p>
</div>
</div>

<div id="outline-container-org4560db0" class="outline-4">
<h4 id="org4560db0"><span class="section-number-4">4.2.3.</span> Settings</h4>
<div class="outline-text-4" id="text-4-2-3">
<p>
ImageJ's default measurement settings are not ideal for PhilaJ, so we need to change those defaults.  Select "Analyze -&gt; Set Measurements" from the main ImageJ menu:
</p>


<div id="orge75f130" class="figure">
<p><img src="PhilaJ-setup-measure-menu.gif" alt="PhilaJ-setup-measure-menu.gif" align="center" width="800px" />
</p>
</div>

<p>
The following dialog box will appear:
</p>


<div id="org269f49a" class="figure">
<p><img src="PhilaJ-setup-measure-dialog.gif" alt="PhilaJ-setup-measure-dialog.gif" align="center" width="400px" />
</p>
</div>

<p>
It is important to select the three highlighted options:
</p>
<ul class="org-ul">
<li>Area</li>
<li>Bounding rectangle</li>
<li>Display label</li>
</ul>
<p>
You can select others options as desired.
</p>

<p>
Why are these options important?
</p>
<ul class="org-ul">
<li><b>Area:</b> This one is used for centering, design, and paper measurements.</li>
<li><b>Bounding rectangle:</b>  This one is used by most tools.  It identifies the location and size of an ROI.</li>
<li><b>Display label:</b> PhilaJ frequently adds multiple measurements to the results window, and without labels they aren't very useful.</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org3c949cc" class="outline-3">
<h3 id="org3c949cc"><span class="section-number-3">4.3.</span> Activate PhilaJ</h3>
<div class="outline-text-3" id="text-4-3">
<p>
The PhilaJ toolset is activated via the toolset menu:
</p>


<div id="org25d047f" class="figure">
<p><img src="PhilaJ-toolbar-b4m-anno.gif" alt="PhilaJ-toolbar-b4m-anno.gif" align="center" width="800px" />
</p>
</div>

<p>
Then the PhilaJ macro set is selected:
</p>


<div id="orga907c8b" class="figure">
<p><img src="PhilaJ-toolbar-tbm-anno.gif" alt="PhilaJ-toolbar-tbm-anno.gif" align="center" width="800px" />
</p>
</div>

<p>
Once activated, it will add a few buttons to the toolbar:
</p>


<div id="orgc888cee" class="figure">
<p><img src="PhilaJ-toolbar-pmi-anno.gif" alt="PhilaJ-toolbar-pmi-anno.gif" align="center" width="800px" />
</p>
</div>

<p>
In addition to the buttons, a few keyboard shortcuts will now be activated!
</p>
</div>
</div>

<div id="outline-container-keybindings" class="outline-3">
<h3 id="keybindings"><span class="section-number-3">4.4.</span> Keyboard short-cuts</h3>
<div class="outline-text-3" id="text-keybindings">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Key</th>
<th scope="col" class="org-left">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>[1]</code> (top row digit)</td>
<td class="org-left"><a href="#phil-rotate"><code>Rotate Line to Horizontal</code></a> &#x2013; Also clears the overlay</td>
</tr>

<tr>
<td class="org-left"><code>[2]</code> (top row digit)</td>
<td class="org-left"><a href="#phil-rotate"><code>Rotate 90 Degrees Right</code></a> &#x2013; Also clears the overlay</td>
</tr>

<tr>
<td class="org-left"><code>[3]</code> (top row digit)</td>
<td class="org-left">Zoom To Selection</td>
</tr>

<tr>
<td class="org-left"><code>[5]</code> (top row digit)</td>
<td class="org-left">Zoom 100% @ Cursor or if already zoomed at 100%, then switch to original zoom</td>
</tr>

<tr>
<td class="org-left"><code>[o]</code> (lowercase)</td>
<td class="org-left"><a href="#load-save-magic"><code>Load image &amp; ROI sidecar.  Attempt to set Scale.</code></a></td>
</tr>

<tr>
<td class="org-left"><code>[s]</code> (lowercase)</td>
<td class="org-left"><a href="#load-save-magic"><code>Save image &amp; ROI sidecar</code></a></td>
</tr>

<tr>
<td class="org-left"><code>[S]</code> (Uppercase)</td>
<td class="org-left"><a href="#load-save-magic"><code>SaveAs image &amp; ROI sidecar</code></a></td>
</tr>

<tr>
<td class="org-left"><code>[J]</code> (Uppercase)</td>
<td class="org-left"><a href="#sub-image"><code>Selection to JPEG</code></a></td>
</tr>

<tr>
<td class="org-left"><code>[g]</code> (lowercase)</td>
<td class="org-left">Restore/Toggle PhilaJ Overlay</td>
</tr>

<tr>
<td class="org-left"><code>[p]</code> (lowercase)</td>
<td class="org-left">Reserved</td>
</tr>

<tr>
<td class="org-left"><code>[M]</code> (lowercase)</td>
<td class="org-left"><a href="#overlay-measure"><code>Overlay/ROI Measure</code></a></td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-tool-set-buttons" class="outline-3">
<h3 id="tool-set-buttons"><span class="section-number-3">4.5.</span> Tool-set Buttons</h3>
<div class="outline-text-3" id="text-tool-set-buttons">

<div id="org6ccd6f2" class="figure">
<p><img src="PhilaJ-philaj-buttons.gif" alt="PhilaJ-philaj-buttons.gif" />
</p>
</div>
</div>

<div id="outline-container-orga413148" class="outline-4">
<h4 id="orga413148"><span class="section-number-4">4.5.1.</span> Overlay Menu (images &amp; annotations drawn over the stamp image in a nondestructive way)</h4>
<div class="outline-text-4" id="text-4-5-1">
<dl class="org-dl">
<dt><img src="PhilaJ-button-overlay.gif" alt="PhilaJ-button-overlay.gif" /></dt><dd><ul class="org-ul">
<li>&#x2014;</li>
<li><code>Remove/Reset Overlay</code></li>
<li><a href="#overlay-measure"><code>Overlay/ROI Measure</code></a></li>
<li>&#x2014;</li>
<li><a href="#dynamic-perf-gauge"><code>Dynamic Perforation Gauge</code></a></li>
<li><a href="#dynamic-perf-gauge"><code>Dynamic Perforation Gauge Options</code></a></li>
<li><a href="#dynamic-perf-gauge"><code>Dynamic Perforation Gauge Presets</code></a></li>
<li>&#x2014;</li>
<li><a href="#static-perf-gauge"><code>Instanta-Style Perforation Gauge</code></a></li>
<li><a href="#static-perf-gauge"><code>Instanta-Style Perforation Gauge Options</code></a></li>
<li>&#x2014;</li>
<li><a href="#static-perf-gauge"><code>Specialized Perforation Gauge</code></a></li>
<li><a href="#static-perf-gauge"><code>Specialized Perforation Gauge Options</code></a></li>
<li><a href="#static-perf-gauge"><code>Single Line Specialized Perforation Gauge Options</code></a></li>
<li><a href="#static-perf-gauge"><code>Single Line Specialized Perforation Gauge Presets</code></a></li>
<li><a href="#custom-spec-gauge"><code>Install New Specialized Gauge</code></a></li>
<li>&#x2014;</li>
<li><a href="#pos-finder"><code>Position Finder</code></a></li>
<li><a href="#pos-finder"><code>Position Finder Options</code></a></li>
<li>&#x2014;</li>
<li><a href="#coord-tool"><code>Coordinate Tool</code></a></li>
<li><a href="#coord-tool"><code>Coordinate Tool Options</code></a></li>
<li>&#x2014;</li>
<li><a href="#grill-tool"><code>Grill</code></a></li>
<li><a href="#grill-tool"><code>Grill Type &amp; Options</code></a></li>
<li><a href="#grill-tool"><code>Grill Options</code></a></li>
</ul></dd>
</dl>
</div>
</div>

<div id="outline-container-tool-set-buttons-interact" class="outline-4">
<h4 id="tool-set-buttons-interact"><span class="section-number-4">4.5.2.</span> Overlay Interaction tool</h4>
<div class="outline-text-4" id="text-tool-set-buttons-interact">
<dl class="org-dl">
<dt><img src="PhilaJ-button-overlayInteract.gif" alt="PhilaJ-button-overlayInteract.gif" /></dt><dd><p>
The <a href="#tool-set-buttons-interact"><code>PhilaJ Overlay Interaction Tool</code></a> allows a user to manipulate overlays created by the previous menu.  For example, the
<a href="#static-perf-gauge"><code>Instanta-Style Perforation Gauge</code></a> and <a href="#static-perf-gauge"><code>Specialized Perforation Gauge</code></a> may be moved around over an image in
order to align them with a stamp's perforations.  Some overlays, like the <a href="#dynamic-perf-gauge"><code>Dynamic Perforation Gauge</code></a>, may be manipulated in more
complex ways.  Non-PhilaJ overlays can be moved around with this tool.
</p>

<p>
This toolbar button has a super power &#x2013; Right click on it to bring up the primary options dialog for the currently active PhilaJ overlay.
</p></dd>
</dl>
</div>
</div>

<div id="outline-container-org23dc5f3" class="outline-4">
<h4 id="org23dc5f3"><span class="section-number-4">4.5.3.</span> Image Scale Menu (so we can measure things like distances &amp; perforations)</h4>
<div class="outline-text-4" id="text-4-5-3">
<dl class="org-dl">
<dt><img src="PhilaJ-button-scale.gif" alt="PhilaJ-button-scale.gif" /> </dt><dd><ul class="org-ul">
<li>&#x2014;</li>
<li><a href="#set-scale-dpi"><code>Set scale for DPI: 2410x2398</code></a>   &#x2013; This odd DPI is what I get at the center of the platen on my Epson scanner. ;)</li>
<li><a href="#set-scale-dpi"><code>Set scale for DPI: 2400</code></a></li>
<li><a href="#set-scale-dpi"><code>Set scale for DPI: 1200</code></a></li>
<li><a href="#set-scale-dpi"><code>Set scale for DPI: 600</code></a></li>
<li><a href="#set-scale-dpi"><code>Set scale for DPI: 300</code></a></li>
<li>&#x2014;</li>
<li><a href="#set-scale-dpi"><code>Set scale for DPI</code></a></li>
<li><a href="#set-scale-dpi"><code>Set Scale for Hoiz &amp; Vert DPI</code></a></li>
<li><a href="#set-scale-filename"><code>Set scale from DPI file name</code></a></li>
<li>&#x2014;</li>
<li><a href="#scale-roi"><code>Set scale from scale ROI</code></a></li>
<li><a href="#scale-roi"><code>Create scale ROI and add it to the ROI manager</code></a></li>
<li>&#x2014;</li>
<li><a href="#scale-alt"><code>Set Scale via standard ImageJ dialog</code></a></li>
<li><a href="#scale-alt"><code>Set Scale 1D</code></a></li>
<li><a href="#scale-alt"><code>Set Scale 1D from measurement results table</code></a></li>
<li><a href="#scale-alt"><code>Set Scale 2D</code></a></li>
<li><a href="#scale-alt"><code>Set Scale 2D from measurement results table</code></a></li>
<li><a href="#scale-rpi"><code>Set Scale for Stereo Microscope Photograph</code></a></li>
<li>&#x2014;</li>
<li><a href="#set-scale-convert"><code>Convert image scale units to mm</code></a></li>
<li><a href="#scale-image-scale"><code>Shrink image to make pixels square</code></a></li>
<li><a href="#scale-image-scale"><code>Resize image to target DPI</code></a></li>
<li>&#x2014;</li>
<li><code>Remove Scale</code></li>
<li><a href="#scale-report"><code>Scale Report</code></a></li>
</ul></dd>
</dl>
</div>
</div>

<div id="outline-container-org8e0792e" class="outline-4">
<h4 id="org8e0792e"><span class="section-number-4">4.5.4.</span> Acquiring &amp; Saving Images &amp; Data Menu</h4>
<div class="outline-text-4" id="text-4-5-4">
<dl class="org-dl">
<dt><img src="PhilaJ-button-files.gif" alt="PhilaJ-button-files.gif" /> </dt><dd><ul class="org-ul">
<li>&#x2014;</li>
<li><a href="#rpi-settings"><code>Configure RPI Microscope Camera</code></a></li>
<li><a href="#rpi-preview"><code>Live Video From RPI Microscope Camera (no capture)</code></a></li>
<li><a href="#rpi-capture"><code>Capture Image From RPI Microscope Camera</code></a></li>
<li><a href="#rpi-load"><code>Load Previous RPI Microscope Camera Captures</code></a></li>
<li>&#x2014;</li>
<li><a href="#roi-sidecars"><code>Load ROIs from PhilaJ sidecar file</code></a></li>
<li><a href="#roi-sidecars"><code>Save ROIs to PhilaJ ROI sidecar file</code></a></li>
<li>&#x2014;</li>
<li><a href="#note-sidecars"><code>Load Notes from PhilaJ sidecar file</code></a></li>
<li>&#x2014;</li>
<li><a href="#load-save-magic"><code>Load image &amp; ROI sidecar.  Attempt to set Scale.</code></a></li>
<li><a href="#load-save-magic"><code>Save image &amp; ROI sidecar</code></a></li>
<li><a href="#load-save-magic"><code>SaveAs image &amp; ROI sidecar</code></a></li>
<li>&#x2014;</li>
<li><code>Save Image As PNG</code></li>
<li><code>Load Image</code></li>
<li>&#x2014;</li>
<li><a href="#cleaning-up-windows-n-files"><code>Delete current image file</code></a></li>
<li><a href="#cleaning-up-windows-n-files"><code>Delete current image file &amp; close image window</code></a></li>
<li><a href="#cleaning-up-windows-n-files"><code>Delete current image file &amp; close associated windows</code></a></li>
<li>&#x2014;</li>
<li><a href="#cleaning-up-windows-n-files"><code>Close PhilaJ Windows</code></a></li>
<li><a href="#cleaning-up-windows-n-files"><code>Close PhilaJ &amp; Related Windows</code></a></li>
<li><a href="#cleaning-up-windows-n-files"><code>Close Image, PhilaJ, &amp; Related Windows</code></a></li>
<li>&#x2014;</li>
<li><a href="#bulk-processing"><code>Process a directory of scans</code></a></li>
<li><a href="#sub-image"><code>Selection to image (with scale)</code></a></li>
<li><a href="#sub-image"><code>Selection to JPEG</code></a></li>
</ul></dd>
</dl>
</div>
</div>

<div id="outline-container-orga5ae52e" class="outline-4">
<h4 id="orga5ae52e"><span class="section-number-4">4.5.5.</span> Everything Else Menu</h4>
<div class="outline-text-4" id="text-4-5-5">
<dl class="org-dl">
<dt><img src="PhilaJ-button-misc.gif" alt="PhilaJ-button-misc.gif" /> </dt><dd><ul class="org-ul">
<li>&#x2014;</li>
<li><code>ROI Manager...</code></li>
<li><a href="#roi-name-tools"><code>Bulk ROI Rename</code></a></li>
<li><a href="#roi-cleanup"><code>Clean up ROI list</code></a></li>
<li><a href="#centering-measurements"><code>Delete centering report ROIs</code></a></li>
<li>&#x2014;</li>
<li><a href="#centering-measurements"><code>Measure Design</code></a></li>
<li><a href="#centering-measurements"><code>Measure Paper</code></a></li>
<li><a href="#centering-measurements"><code>Centering Report</code></a></li>
<li><a href="#measure-edges"><code>Coil Edge Check</code></a></li>
<li><a href="#reuse-dynamic-perf-roi"><code>Measure Dynamic Perf ROI</code></a></li>
<li><a href="#reuse-dynamic-perf-roi"><code>Measure ALL Dynamic Perf ROIs</code></a></li>
<li>&#x2014;</li>
<li><a href="#measure-edges"><code>Angle &amp; Distance Between Edges</code></a></li>
<li><a href="#measure-offset"><code>Offset Between ROIs</code></a></li>
<li><code>Create grill box ROI from grill points ROI</code></li>
<li>&#x2014;</li>
<li><a href="#phil-rotate"><code>Rotate Line to Horizontal</code></a></li>
<li><a href="#phil-rotate"><code>Rotate 90 Degrees Right</code></a></li>
<li>&#x2014;</li>
<li><a href="#sheet-tools"><code>Separate stamp sheet</code></a></li>
<li>&#x2014;</li>
<li><a href="#phil-units"><code>Convert Distance to Perforation Measurement</code></a></li>
<li><a href="#phil-units"><code>Convert Kiusalas to Perforations per 2cm</code></a></li>
<li><a href="#phil-units"><code>Convert Perforations per 2cm to Kiusalas</code></a></li>
<li><a href="#phil-units"><code>Convert length to millimeters</code></a></li>
<li>&#x2014;</li>
<li><a href="#phil-data"><code>Kiusalas Table</code></a></li>
<li><a href="#phil-data"><code>Grill Table</code></a></li>
<li><code>PhilaJ Help</code></li>
</ul></dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-orgce39319" class="outline-3">
<h3 id="orgce39319"><span class="section-number-3">4.6.</span> PhilaJ Tools</h3>
<div class="outline-text-3" id="text-4-6">
</div>
<div id="outline-container-dynamic-perf-gauge" class="outline-4">
<h4 id="dynamic-perf-gauge"><span class="section-number-4">4.6.1.</span> Dynamic perforation gauge</h4>
<div class="outline-text-4" id="text-dynamic-perf-gauge">

<div id="orga4ef803" class="figure">
<p><img src="PhilaJ-overlay-dynamicPerf.gif" alt="PhilaJ-overlay-dynamicPerf.gif" align="center" width="800" />
</p>
</div>

<p>
The dynamic perforation gauge is a fully interactive, digital perforation gauge capable of making very precise measurements of both perforations and hole
size.  With physical perforation gauges one finds the gauge row that most closely matches the perforation holes.  The dynamic gauge only has one row of
perforation dots, and the user adjusts the location (and optionally size) of these dots to match the perforation holes.  The dynamic perforation gauge is
started by selecting one of the following menu items in the overlay menu: <a href="#dynamic-perf-gauge"><code>Dynamic Perforation Gauge</code></a>,
<a href="#dynamic-perf-gauge"><code>Dynamic Perforation Gauge Options</code></a>, or <a href="#dynamic-perf-gauge"><code>Dynamic Perforation Gauge Presets</code></a>.
</p>

<p>
When using the <a href="#dynamic-perf-gauge"><code>Dynamic Perforation Gauge Options</code></a> menu item, the dialog below will appear before the perforation gauge overlay is
drawn.
</p>


<div id="org6765c31" class="figure">
<p><img src="PhilaJ-dialog-dynamicPerf-Options.gif" alt="PhilaJ-dialog-dynamicPerf-Options.gif" align="center" width="400" />
</p>
</div>

<p>
When using the <a href="#dynamic-perf-gauge"><code>Dynamic Perforation Gauge Presets</code></a> menu item, the dialog below will appear.  These presets will set the initial hole
size &amp; spacing.  Immediately after the preset dialog, the options dialog will be displayed just as if the <a href="#dynamic-perf-gauge"><code>Dynamic Perforation Gauge
Options</code></a> had been used.
</p>


<div id="org599af26" class="figure">
<p><img src="PhilaJ-dialog-dynamicPerf-Presets.gif" alt="PhilaJ-dialog-dynamicPerf-Presets.gif" align="center" width="400" />
</p>
</div>

<p>
The initial placement of the overlay may be controlled by an active line ROI when <a href="#dynamic-perf-gauge"><code>Dynamic Perforation Gauge</code></a> or
<a href="#dynamic-perf-gauge"><code>Dynamic Perforation Gauge Options</code></a> is used &#x2013; but not <a href="#dynamic-perf-gauge"><code>Dynamic Perforation Gauge Presets</code></a>.
</p>

<ul class="org-ul">
<li>If a line ROI was active when the menu option was selected, then the gauge will appear on the line</li>
<li>If a line ROI is one previously created by the dynamic perforation gauge, then the number of perforation holes and perforation hole size may be
automatically set.</li>
<li>If no ROI is selected, then the gauge appears with the first dot in the upper left of the image and extending to the right</li>
</ul>

<p>
Once the gauge is displayed, it may be dynamically adjusted onscreen.  While being adjusted a live perforation measurement may displayed.  This live
measurement may be presented in one of two ways: 1) graphically over the image itself, or 2) in a popup window.
</p>

<ul class="org-ul">
<li>Click and drag any perforation gauge dot to move the dot around.  Note that the end dot furthest away from the one you clicked on stays put while all the
other dots follow your mouse around.  The typical procedure is to drag an end dot to the first hole on the stamp, and then drag a dot on the other end of
the perforation gauge to a hole on the other side of the stamp.</li>
<li>If the HUD perforation report is being displayed, clicking on the HUD will allow you to drag just the HUD around.  This is useful when the HUD is placed
over a cluttered part o the stamp making the HUD hard to read.</li>
<li>Clicking outside of the HUD and any perforation allows you to drag the entire perforation gauge line around on the display.  This can be useful if you have just
measured perfs on one edge, and wish to measure the other edge.</li>
<li>Shift-Click outside of any perforation and drag to resize the perforation gauge holes.  Moving away from the gauge makes the holes larger, and moving
toward the gauge makes them smaller.  The rate of change as you drag is slowed down to make precise chances possible, but this means that if large changes
need to be made to the size you might have to repeat the procedure.</li>
<li>Dots can be added or removed with an Alt-Click
<ul class="org-ul">
<li>Alt-Click on a dot, and all the dots left/right of that dot will be removed to the closet gauge end.</li>
<li>Alt-Click outside of any dot, and all a new dot will be added to the end of the gauge closet to the clicked point</li>
<li>The number of dots may also be added by bringing up the options dialog, and changing the value in the dialog.  When changed in this manner, the end dots
stay put and the gauge is redrawn.</li>
</ul></li>
<li>Control-click to get a perforation report or use the <a href="#overlay-measure"><code>Overlay/ROI Measure</code></a> command</li>
</ul>

<p>
In summary:
</p>

<table border="2 solid #ccc" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" align="center">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Event</th>
<th scope="col" class="org-left">Where</th>
<th scope="col" class="org-left">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">SHIFT-CLICK &amp; Drag</td>
<td class="org-left">off dot</td>
<td class="org-left">resize dots</td>
</tr>

<tr>
<td class="org-left">CLICK &amp; Drag</td>
<td class="org-left">on HUD</td>
<td class="org-left">translate HUD</td>
</tr>

<tr>
<td class="org-left">CLICK &amp; Drag</td>
<td class="org-left">on dot</td>
<td class="org-left">translate dot</td>
</tr>

<tr>
<td class="org-left">ALT-CLICK</td>
<td class="org-left">on dot</td>
<td class="org-left">delete end dots after clicked dot</td>
</tr>

<tr>
<td class="org-left">ALT-CLICK</td>
<td class="org-left">off dot</td>
<td class="org-left">Add a dot on end closest to click</td>
</tr>

<tr>
<td class="org-left">CONTROL-CLICK</td>
<td class="org-left">N/A</td>
<td class="org-left">Get a perforation report</td>
</tr>

<tr>
<td class="org-left"><code>[M]</code></td>
<td class="org-left">N/A</td>
<td class="org-left">Get a perforation report</td>
</tr>
</tbody>
</table>

<p>
Once the gauge is adjusted to align with the stamp's perforation holes, a detailed perforation report may be generated via the
<a href="#overlay-measure"><code>Overlay/ROI Measure</code></a> menu selection or by pressing the <a href="#keybindings"><code>[M]</code></a> key &#x2013; note that is an upper case "M".  
</p>

<p>
The report will be in a popup (just like the live measurement popup) if the option "<code>Results in measure table</code>" is not selected, otherwise it will be in the
ImageJ measurement results window.  If the "<code>ROI Manager Use</code>" option is set to anything other than "<code>NONE</code>", then ROIs describing the perforation gauge will
be saved in ROI manager for later recall &#x2013; see the section <a href="#reuse-dynamic-perf-roi">Reusing Dynamic Perforation Gauge ROIs</a>.
</p>
</div>
</div>
<div id="outline-container-reuse-dynamic-perf-roi" class="outline-4">
<h4 id="reuse-dynamic-perf-roi"><span class="section-number-4">4.6.2.</span> Reusing Dynamic Perforation Gauge ROIs</h4>
<div class="outline-text-4" id="text-reuse-dynamic-perf-roi">
<p>
ROIs created by the <a href="#dynamic-perf-gauge"><code>Dynamic Perforation Gauge</code></a> can be used in a few different ways.  Most directly, if one is active when the
<a href="#dynamic-perf-gauge"><code>Dynamic Perforation Gauge</code></a> menu is selected, then the <a href="#dynamic-perf-gauge"><code>Dynamic Perforation Gauge</code></a> will startup with
matching perforation spacing, hole count, and hole size.  At this point the perforations can be remeasured, or the gauge may be adjusted.
</p>

<p>
The <a href="#phil-units"><code>Convert Distance to Perforation Measurement</code></a> menu item will also create a perforation report if a <a href="#dynamic-perf-gauge"><code>Dynamic
Perforation Gauge</code></a> <b>line</b> ROI is active when the menu is selected.  In this case a dialog will appear allowing the user to manually adjust the numbers
before the report is generated.
</p>

<p>
To simply remeasure the perfs, the <a href="#reuse-dynamic-perf-roi"><code>Measure Dynamic Perf ROI</code></a> item is the way to go.  To generate a summary report for every
<a href="#dynamic-perf-gauge"><code>Dynamic Perforation Gauge</code></a> ROI in the ROI Manager, use the <a href="#reuse-dynamic-perf-roi"><code>Measure ALL Dynamic Perf ROIs</code></a> menu item.
</p>
</div>
</div>
<div id="outline-container-static-perf-gauge" class="outline-4">
<h4 id="static-perf-gauge"><span class="section-number-4">4.6.3.</span> Static perforation gauges</h4>
<div class="outline-text-4" id="text-static-perf-gauge">
<p>
The "static" perforation gauges are just like the physical perforation gauges we use.  They work just like physical perforation gauges too.  That is to say,
one activates the gauges and then moves it around to line up the gauge on the perforations to be measured.  In PhilaJ they come in two varieties:
</p>

<ul class="org-ul">
<li>"Instanta-Style"   &#x2013; Continuous lines graduated with perforation measurements</li>
<li>"Specialist-Style" &#x2013; rows of dots like the Kiusalas gauges</li>
</ul>


<div id="org9b2a23b" class="figure">
<p><img src="PhilaJ-overlay-instaPerf1.gif" alt="PhilaJ-overlay-instaPerf1.gif" align="center" width="800" />
</p>
</div>


<div id="orgb7f6f4b" class="figure">
<p><img src="PhilaJ-overlay-spl.gif" alt="PhilaJ-overlay-spl.gif" align="center" width="800" />
</p>
</div>

<p>
These tools are found in the overlay menu. <a href="#static-perf-gauge"><code>Instanta-Style Perforation Gauge</code></a> &amp; <a href="#static-perf-gauge"><code>Specialized Perforation
Gauge</code></a> will draw the gauge immediately using the most recent, or default, settings.  If you wish to change settings first, then the
<a href="#static-perf-gauge"><code>Instanta-Style Perforation Gauge Options</code></a> &amp; <a href="#static-perf-gauge"><code>Specialized Perforation Gauge Options</code></a> menu items will pop up a
settings dialog before drawing the overlay.
</p>


<div id="orgd401bc1" class="figure">
<p><img src="PhilaJ-dialog-instaPerf-Options.gif" alt="PhilaJ-dialog-instaPerf-Options.gif" align="center" width="400" />
</p>
</div>


<div id="org8dfbc78" class="figure">
<p><img src="PhilaJ-dialog-splPerf-Options.gif" alt="PhilaJ-dialog-splPerf-Options.gif" align="center" width="400" />
</p>
</div>

<p>
One "moves" the gauge around via the <a href="#tool-set-buttons-interact"><code>PhilaJ Overlay Interaction Tool</code></a> &#x2013; the button just to the right of the overlay menu
button.  Simply click and drag while the <a href="#tool-set-buttons-interact"><code>PhilaJ Overlay Interaction Tool</code></a> is active to move the gauge around.
</p>

<p>
Note that the stamp perforations must be perfectly lined up on a horizontal line to use these gauges!  To do that, draw a line along the tops/bottoms of the
perf holes, and then use the <a href="#phil-rotate"><code>Rotate Line to Horizontal</code></a> tool &#x2013; in the misc menu or via the keybinding <a href="#keybindings"><code>[1]</code></a>.  After you
have measured the horizontal perforations and wish to measure the vertical ones, rotate the image 90 degrees via the <a href="#phil-rotate"><code>Rotate 90 Degrees Right</code></a> tool
&#x2013; in the misc menu or via the keybinding <a href="#keybindings"><code>[2]</code></a>.
</p>

<p>
Unlike physical gauges, these gauges can be customized in various ways.  First the graphical presentation (colors, line widths, etc&#x2026;) can all be customized
to make them more readable.  Secondly, they can be customized geometrically as well.  The Instanta-Style gauges can have the overall range adjusted and the
graduations (1/10, 1/4, 1/2) adjusted.  Note that by reducing the range one can obtain very accurate measurements with the Instanta-Style gauge.  
</p>


<div id="org959b2ae" class="figure">
<p><img src="PhilaJ-overlay-instaPerf2.gif" alt="PhilaJ-overlay-instaPerf2.gif" align="center" width="800" />
</p>
</div>

<p>
The specialist-style options dialog provides a drop down of several gauges (Kiusalas, traditional Kiusalas, Bari Wolf, etc&#x2026;).  The end user can add to this
list by saving CSV files describing new gauges (see: <a href="#custom-spec-gauge"><code>Install New Specialized Gauge</code></a>).
</p>

<p>
If you just need a custom one row specialist-style gauge, then you can use the single line specialist gauge.  It allows the user to specify the perforation
frequency and perf sizes in a popup dialog.  It automatically converts various measures for frequency and dot size so you don't have to use millimeters.  I
use this sometimes when working with a pile of stamps that need to be divided into two perforation groups &#x2013; i.e. a stamp fits the gauge or doesn't.  This
gauge is available via the <a href="#static-perf-gauge"><code>Single Line Specialized Perforation Gauge Options</code></a> &amp; <a href="#static-perf-gauge"><code>Single Line Specialized
Perforation Gauge Presets</code></a> menu options.
</p>
</div>
</div>

<div id="outline-container-custom-spec-gauge" class="outline-4">
<h4 id="custom-spec-gauge"><span class="section-number-4">4.6.4.</span> User Installable Customized Specialist Gauges</h4>
<div class="outline-text-4" id="text-custom-spec-gauge">
<p>
Then menu option <a href="#custom-spec-gauge"><code>Install New Specialized Gauge</code></a> in the overlay menu allows one to install new specialized gauges.  
</p>

<p>
New gauges are described via a CSV file &#x2013; which you can make with a text editor or Excel.  These files contain three columns:
</p>
<ul class="org-ul">
<li>Gaps &#x2013; the center to center distance between perf holes (in millimeters)</li>
<li>Hole Sizes &#x2013; the diameter of the hole (in millimeters)</li>
<li>Preset &#x2013; If "Y" then the line will be included presets for the one line specialized gauges and the dynamic perforation gauge.</li>
<li>Labels &#x2013; a bit of text to identify each row of perforations</li>
</ul>

<p>
Here is an example of a custom gauge CSV file:
</p>

<div class="org-src-container">
<pre class="src src-text"># Lines that start with a # are ignored -- they are comments
#         gap,         hole,P,Labels
2.03850000000,0.95000000000,N,Sm  9.8
2.03300000000,0.95000000000,N,Sm  9.9
2.03300000000,1.10000000000,N,Lg  9.9
1.90988461538,1.10000000000,N,Lg 10.5
1.81983621474,1.10000000000,N,Lg 11.0
1.77257821501,1.10000000000,N,Lg 11.3
</pre>
</div>

<p>
The <a href="#custom-spec-gauge"><code>Install New Specialized Gauge</code></a> menu option simply queries the user for a CSV file name, an copies it into the following
directory:
</p>

<p>
<code>~/.philaj/perfs</code>
</p>

<p>
The "<code>~</code>" means your home directory.  On my windows machine, that expands to "<code>C:\Users\richmit\.philaj\perfs</code>".  On Linux and a mac, that expands to
"<code>/home/richmit/.philaj/perfs</code>".  Note the "<code>richmit</code>" part is my username.
</p>

<p>
You don't need to use the <a href="#custom-spec-gauge"><code>Install New Specialized Gauge</code></a> menu option &#x2013; you can copy them in via the command line or a file
explorer-like tool if you wish.  All that matters is that they are in the correct place.  Once they are installed, the new gauges will show up in the
specialized perforation options dialog.
</p>

<p>
Note the filenames are used much like ImageJ macro files.  For example, a file named "<code>AM_Post_BEP.csv</code>" will result in a menu option named "<code>AM Post BEP</code>" &#x2013;
i.e. the underscores are turned into spaces and the extension is removed.
</p>

<p>
See the section <a href="#spec-gauge-list">Available Specialist gauges and presets</a> for more information regarding gauges shipped with PhilaJ.
</p>
</div>
</div>

<div id="outline-container-centering-measurements" class="outline-4">
<h4 id="centering-measurements"><span class="section-number-4">4.6.5.</span> Measuring Design &amp; Margins</h4>
<div class="outline-text-4" id="text-centering-measurements">
<p>
PhilaJ can be used to make various centering &amp; paper measurements.  
</p>

<p>
These tools require the design and/or paper edges to be identified via ROIs.  When running one of these measurement tools, they look in the ROI manager for an
appropriately named ROI first.  If a single usable ROI is found, then it is used.  If multiple appropriate ROIs are found, then the user is ask to select the
one to use.  If no appropriate ROIs are found, then the user is prompted to create the required ROI(s) &#x2013; these new ROIs are automatically placed in the ROI
manager with an appropriate names.
</p>

<p>
We have three measurement functions.  The first two are quite simple: <a href="#centering-measurements"><code>Measure Design</code></a> &amp; <a href="#centering-measurements"><code>Measure
Paper</code></a>.  They simply measure the design (or paper) and the its bounding box, and place/update a bounding box ROI in the ROI manager.  Both the ROI <b>and</b> its
<a href="#bb-hr-roi">bounding box</a> are measured because these two functions do <b>not</b> require the ROIs to be rectangles &#x2013; so the two measurements might be different.
</p>

<p>
The most interesting command is the <a href="#centering-measurements"><code>Centering Report</code></a> option which pops up a dialog box with a number of measured values related
to centering &amp; margins.  The centering report requires both a paper and a design ROI, and the paper ROI <b>must</b> be a rectangle.  A "margin" is a rectangular
ROI of maximal size between one edge of the paper ROI and the design.  They are denoted in yellow in the image below.
</p>


<div id="org80def14" class="figure">
<p><img src="PhilaJ-meas-centeringRep.gif" alt="PhilaJ-meas-centeringRep.gif" align="center" width="800px" />
</p>
</div>
</div>

<div id="outline-container-org5229236" class="outline-5">
<h5 id="org5229236"><span class="section-number-5">4.6.5.1.</span> Centering Metrics</h5>
<div class="outline-text-5" id="text-4-6-5-1">
<p>
No universal standard exists for how to measure centering, so I have included several values commonly used by various groups.  If you have a favorite
centering formula that's missing, then drop me a line.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Value</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Margin: Left</td>
<td class="org-left">Size in mm</td>
</tr>

<tr>
<td class="org-left">Margin: Right</td>
<td class="org-left">"</td>
</tr>

<tr>
<td class="org-left">Margin: Top</td>
<td class="org-left">"</td>
</tr>

<tr>
<td class="org-left">Margin: Bottom</td>
<td class="org-left">"</td>
</tr>

<tr>
<td class="org-left">Balance: Left vs Right (?&gt;?)</td>
<td class="org-left">100 multiplied by the smaller margin and divided by the larger one</td>
</tr>

<tr>
<td class="org-left">Balance: Top vs Bottom (?&gt;?)</td>
<td class="org-left">"</td>
</tr>

<tr>
<td class="org-left">Balance: Vert vs Horiz (?&gt;?)</td>
<td class="org-left">"</td>
</tr>

<tr>
<td class="org-left">Balance: Max vs Min (?&gt;?)</td>
<td class="org-left">"</td>
</tr>

<tr>
<td class="org-left">Margin Ratio: Left</td>
<td class="org-left">100.0 multiplied by the size of the named margin and divided by the largest margin size</td>
</tr>

<tr>
<td class="org-left">Margin Ratio: Right</td>
<td class="org-left">"</td>
</tr>

<tr>
<td class="org-left">Margin Ratio: Top</td>
<td class="org-left">"</td>
</tr>

<tr>
<td class="org-left">Margin Ratio: Bottom</td>
<td class="org-left">"</td>
</tr>

<tr>
<td class="org-left">Average Vert (L&amp;R)</td>
<td class="org-left">Average of the sizes</td>
</tr>

<tr>
<td class="org-left">Average Horiz (T&amp;B)</td>
<td class="org-left">"</td>
</tr>

<tr>
<td class="org-left">Average Margin</td>
<td class="org-left">"</td>
</tr>

<tr>
<td class="org-left">Margin Area Ratio: Vert (L&amp;R)</td>
<td class="org-left">100.0 multiplied by the sum of the named margin areas and paper area</td>
</tr>

<tr>
<td class="org-left">Margin Area Ratio: Horiz (T&amp;B)</td>
<td class="org-left">"</td>
</tr>

<tr>
<td class="org-left">Area Ratio: Design Box</td>
<td class="org-left">Area of the <a href="#bb-hr-roi">bounding box</a> for the design</td>
</tr>

<tr>
<td class="org-left">Area Design Box</td>
<td class="org-left">Area in square mm</td>
</tr>

<tr>
<td class="org-left">Area Paper ROI</td>
<td class="org-left">"</td>
</tr>

<tr>
<td class="org-left">Area Horiz (T&amp;B) Margins</td>
<td class="org-left">Sum of the two areas</td>
</tr>

<tr>
<td class="org-left">Area Vert (L&amp;R) Margins</td>
<td class="org-left">"</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org342aff5" class="outline-5">
<h5 id="org342aff5"><span class="section-number-5">4.6.5.2.</span> ROI Details</h5>
<div class="outline-text-5" id="text-4-6-5-2">
<p>
The most common use case is a single stamp with a single design.  In this case the design ROI will be named "<code>design</code>" and the paper ROI will be named
"<code>paper</code>".  For blocks with multiple stamps, each with a single design, the ROIs are augmented with a "stamp ID" like so: "<code>design_SID</code>" &amp; "<code>paper_SID</code>".  For
example, a coil pair might have paper ROIs named "<code>paper_left</code>" &amp; "<code>paper_right</code>".  The "stamp ID" is just an end user label &#x2013; some recommendations labels
may be found in the section <a href="#roi-name-components">About ROI Name Components</a>.  Things get more complex when a stamp has more than one design.  This might
be a double impression, different design components, etc&#x2026;  In this case the design ROI gets a "Suffix" &#x2013; another end user defined label.  For example, a
double impression design ROI pair might be named: "<code>design-imp1</code>" &amp; "<code>design-imp2</code>".  Note that a "stamp ID" starts with an underscore, while a "suffix"
starts with a dash.  This allows us to use both a "stamp ID" and a "suffix".  For example: "<code>design_left-imp1</code>" &amp; "<code>design_left-imp2</code>".
</p>

<p>
For the most common use case (a single stamp with a single design), the software will guide the user in creating &amp; saving ROIs if necessary, and will reuse
them in the future.  This is all automatic.  Thus, for the most common use case, the end user can remain completely ignorant of how the ROIs are stored, named,
and used.
</p>

<p>
All three measurement tools discussed in this section construct <a href="#bb-hr-roi">bounding box</a> ROIs.  In addition, the centering report also creates margin
ROIs.  These ROIs may be deleted with the <a href="#centering-measurements"><code>Delete centering report ROIs</code></a> menu option.  Note only ROIs with an associated ROI in
the ROI manager are deleted.  That is to say "<code>fooBB</code>" will only be deleted if a "<code>foo</code>" ROI exists.  The idea is to only delete bounding box ROIs which may
be recreated.
</p>
</div>
</div>
</div>

<div id="outline-container-coord-tool" class="outline-4">
<h4 id="coord-tool"><span class="section-number-4">4.6.6.</span> Coordinate Tool</h4>
<div class="outline-text-4" id="text-coord-tool">
<p>
The <a href="#coord-tool"><code>Coordinate Tool</code></a> is used to identify "X,Y" coordinates in millimeters on the surface of an object (stamp, sheet, cover, etc&#x2026;) with an
arbitrary origin reference point.  It can be used as a more precise replacement for the Thirkell position finder when the reference point is the upper left
corner of the design bounding box.
</p>


<div id="org893b18c" class="figure">
<p><img src="PhilaJ-overlay-cTool.gif" alt="PhilaJ-overlay-cTool.gif" align="center" width="800" />
</p>
</div>

<p>
The coordinate tool may be started up via the <a href="#coord-tool"><code>Coordinate Tool</code></a> or <a href="#coord-tool"><code>Coordinate Tool Options</code></a> menu selections.  The second
provides a chance to change the tool settings before drawing the overlay:
</p>


<div id="orgf46dd02" class="figure">
<p><img src="PhilaJ-dialog-cTool-Options.gif" alt="PhilaJ-dialog-cTool-Options.gif" align="center" width="400" />
</p>
</div>

<p>
If an ROI is active when the tool is started up, then a popup will ask if the coordinate origin should be set to the upper left hand corner of the current
ROI's bounding box.  This is a handy way to repeatably set the coordinate system. Unlike the <a href="#pos-finder"><code>Position Finder</code></a> tool, this one may be freely
moved around on the image via the <a href="#tool-set-buttons-interact"><code>PhilaJ Overlay Interaction Tool</code></a> (by holding down the <code>[shift]</code> key and dragging with the
left mouse button).
</p>

<p>
Like the <a href="#pos-finder"><code>Position Finder</code></a> tool, clicking on the image with the <a href="#tool-set-buttons-interact"><code>PhilaJ Overlay Interaction Tool</code></a> active adds
a point to the the measurement results with additional columns "<code>relX</code>" &amp; "<code>relY</code>" &#x2013; the distance right and down from the origin in millimeters.  Note a pair
of lines are also temporarily drawn on over the image connecting the point clicked to the X &amp; Y axes of the coordinate system &#x2013; this is only drawn when the
option "<code>Draw Point ROI Axis Guides</code>" is selected in the options dialog.
</p>


<div id="org23529d7" class="figure">
<p><img src="PhilaJ-overlay-cToolPt.gif" alt="PhilaJ-overlay-cToolPt.gif" align="center" width="800" />
</p>
</div>

<p>
One additional feature is the ability to quickly make rectangular selections and even save them to disk.  My primary use case for this feature is to document
plate flaw locations and make tiny JPEGs for inclusion into my albums.  These rectangular selections are made just like the point selections already
discussed, but the <code>[control]</code> key is pressed while clicking.  Note the image below has no "Axis Guides" because the option "<code>Draw Box ROI Axis Guides</code>" was
not selected when this selection was made &#x2013; the default.  Also note that we have <b>two</b> entries in the measurement results window.  The first is for the point
we clicked on, and the second is for the region.
</p>


<div id="org4465dd2" class="figure">
<p><img src="PhilaJ-overlay-cToolBx.gif" alt="PhilaJ-overlay-cToolBx.gif" align="center" width="800" />
</p>
</div>

<p>
The size of the selection is determined by the tool options.  The precise location of the selection is influenced by the "<code>Image Coordinates in JPEGs</code>"
option.  If it is set to "pixels" or "thirkell", then the rectangle will be precisely centered on the point clicked.  If it is set to "physical" and the
region is bigger than 3mm, then the upper left corner of the selection will be on an even millimeter coordinate point.  This "rounding" of the upper left
coordinate point allows us to communicate the location of the flaw image in even millimeter values.  If the option "<code>Save Box Images</code>" is selected, then a
JPEG of the box will be saved.  The image name will, by default, contain the size and coordinates of the selection.  Here is a closeup shot of one of my
albums showing a plate flaw &#x2013; at mm coordinates of (3, 7) on the position 83 stamp:
</p>


<div id="org97d42b7" class="figure">
<p><img src="PhilaJ-eximg-cToolBox.gif" alt="PhilaJ-eximg-cToolBox.gif" align="center" width="400" />
</p>
</div>

<p>
Note the "thirkell" option for units will put the Thirkell coordinates of the point clicked in the JPEG file name.  These coordinates are based on the origin
of the <a href="#coord-tool"><code>Coordinate Tool</code></a> and a 3mm grid size.  Note the region may be set larger or smaller if desired, but the coordinates will always be
based on the standard 3mm grid size of the Thirkell Position Finder.
</p>

<p>
Note the "physical" option always means "millimeters" because all images in PhilaJ are scaled in units of millimeters.
</p>
</div>
</div>
<div id="outline-container-pos-finder" class="outline-4">
<h4 id="pos-finder"><span class="section-number-4">4.6.7.</span> Position Finder</h4>
<div class="outline-text-4" id="text-pos-finder">
<p>
The idea is to identify the <b>location</b> of plate flaws (or anything really) using coordinates in terms of the upper left corner of the design.  Starting with
the upper left corner of the design bounding box we enumerate a grid system (letters on the vertical and numbers on the horizontal).  The traditional grids
are 3mm as used on the Thirkell position finder.  This tool allows one to use different sizes of grids.  When invoked it looks for a design ROI.  If one is
found, then it is used.  Otherwise the user is prompted to create one (it will be placed in the ROI manager for the user for future use).  Like most PhilaJ
overlays things like the fonts and colors may be adjusted.
</p>


<div id="org2040295" class="figure">
<p><img src="PhilaJ-overlay-posFinder.gif" alt="PhilaJ-overlay-posFinder.gif" align="center" width="800" />
</p>
</div>

<p>
This tool is started via the <a href="#pos-finder"><code>Position Finder</code></a> or <a href="#pos-finder"><code>Position Finder Options</code></a> menu selections with the second option showing
an options dialog before drawing the overlay:
</p>


<div id="orgf593b1d" class="figure">
<p><img src="PhilaJ-dialog-posFinder-Options.gif" alt="PhilaJ-dialog-posFinder-Options.gif" align="center" width="400" />
</p>
</div>

<p>
Like many PhilaJ overlays, this one may be interacted with via the <a href="#tool-set-buttons-interact"><code>PhilaJ Overlay Interaction Tool</code></a>.  If the image is clicked
on, then the coordinates of the point clicked will be added to the measurement results window.  If an ROI is defined, and the <a href="#overlay-measure"><code>Overlay/ROI
Measure</code></a> command is used, via the uppercase <a href="#keybindings"><code>[M]</code></a> key, then the ROI will be measured and an extra column will be added to the results for the
position finder coordinates.  In the following image, the first measurement result line is for a clicked pint and the second is for the highlighted ROI.
</p>


<div id="org455ea19" class="figure">
<p><img src="PhilaJ-overlay-posFinderPtROI.gif" alt="PhilaJ-overlay-posFinderPtROI.gif" align="center" width="800" />
</p>
</div>

<p>
I find this tool most useful when referring to literature that uses the Thirkell position finder.  For practical plate flaw locations, I tend to use the
<a href="#coord-tool"><code>Coordinate Tool</code></a> more useful.
</p>
</div>
</div>
<div id="outline-container-measure-edges" class="outline-4">
<h4 id="measure-edges"><span class="section-number-4">4.6.8.</span> Measuring Edges</h4>
<div class="outline-text-4" id="text-measure-edges">
<p>
We are frequently concerned with parallel edges like the straight edges of a coil stamp, paper edges of a souvenir sheet, or rows of perforations.  PhilaJ
provides a generic tool to measure the angle and distance between arbitrary edges in the <a href="#measure-edges"><code>Angle &amp; Distance Between Edges</code></a> menu item.
This tool will prompt the user to make two line selections, and then report some statistics in a popup:
</p>


<div id="orgbc8feda" class="figure">
<p><img src="PhilaJ-meas-edges.gif" alt="PhilaJ-meas-edges.gif" align="center" width="400" />
</p>
</div>

<p>
It also provides a more specialized tool for US coil stamps in the <a href="#measure-edges"><code>Coil Edge Check</code></a> menu item.  This tool will make use of ROIs stored in
the ROI Manager with names like <code>coilEdgeB</code>, <code>coilEdgeL</code>, <code>coilEdgeR</code>, and <code>coilEdgeT</code>.  If no ROIs are found, then the user will be prompted to make line
selections, and the tool will save off these selections in the ROI Manager with appropriate names.  When ROIs are specified, a final report is displayed in a
pop up and the edges used are highlighted on the image.
</p>


<div id="orga98c326" class="figure">
<p><img src="PhilaJ-meas-coil.gif" alt="PhilaJ-meas-coil.gif" align="center" width="800" />
</p>
</div>
</div>
</div>
<div id="outline-container-grill-tool" class="outline-4">
<h4 id="grill-tool"><span class="section-number-4">4.6.9.</span> Grill Tool</h4>
<div class="outline-text-4" id="text-grill-tool">
<p>
The <a href="#grill-tool"><code>Grill</code></a> menu option is used to draw a template of a grill over a stamp image &#x2013; so one may compare the grill marks on a stamp with a
template of the suspected grill type.  When the grill tool starts up it looks in the ROI manager for an ROI named "<code>grill</code>" or "<code>grillPts</code>".  If one is found,
then it is used to place the grill template over the stamp image.  If none are found, then the user will be prompted to draw a rectangle around the grill &#x2013;
this newly created grill ROI will be placed in the ROI manager.
</p>


<div id="orgaa611d5" class="figure">
<p><img src="PhilaJ-overlay-grill.gif" alt="PhilaJ-overlay-grill.gif" align="center" width="800" />
</p>
</div>

<p>
I find it easier to identify a handful of grill points on the edges of a grill than to identify the grill boundary sometimes. The intent is that the "<code>grill</code>"
ROI be a rectangle outline of the grill, while the "<code>grillPts</code>" ROI is a multi-point ROI identifying grill points.
</p>

<p>
When invoked via the "<code>Grill</code>" menu selection, the overlay is immediately drawn using the previous, or default settings.  By default an "E" grill is drawn with
17 vertical points.  This may be changed by using the <a href="#grill-tool"><code>Grill Type &amp; Options</code></a> menu selection to start the tool.  This selection will first
show a grill type selection dialog:
</p>


<div id="org044ee44" class="figure">
<p><img src="PhilaJ-dialog-grill-Type.gif" alt="PhilaJ-dialog-grill-Type.gif" align="center" width="400" />
</p>
</div>

<p>
This dialog will be followed by the grill options dialog, the same dialog you get when you use the <a href="#grill-tool"><code>Grill Options</code></a> menu selection:
</p>


<div id="org9c03e43" class="figure">
<p><img src="PhilaJ-dialog-grill-Options.gif" alt="PhilaJ-dialog-grill-Options.gif" align="center" width="400" />
</p>
</div>

<p>
It is typical to toggle through a grill or two in order to find the one that fits best.  Note the options dialog contains the usual customization options like
line color and width, but it also contains several options regarding what parts of the grill template are drawn.  For difficult grills it is worth playing
around with these options.
</p>


<div id="org2593b75" class="figure">
<p><img src="PhilaJ-dialog-grill-Options2.gif" alt="PhilaJ-dialog-grill-Options2.gif" align="center" width="400" />
</p>
</div>

<p>
The <a href="#tool-set-buttons-interact"><code>PhilaJ Overlay Interaction Tool</code></a> allows one to drag the grill template around on the screen, but you must update the
"<code>grill</code>" or "<code>grillPts</code>" ROI to make the grill appear in the new location for future invocations of the grill tool.  This may be easily done via the
<a href="#overlay-measure"><code>Overlay/ROI Measure</code></a> command, bound to uppercase <a href="#keybindings"><code>[M]</code></a> &#x2013; this will create/update an ROI named "<code>grill</code>" in the ROI
manager with the current grill outline.  This is also a handy way to convert a "<code>grillPts</code>" ROI into a rectangular "<code>grill</code>" ROI.
</p>
</div>
</div>
<div id="outline-container-sheet-tools" class="outline-4">
<h4 id="sheet-tools"><span class="section-number-4">4.6.10.</span> Working With Multiples &amp; Sheets</h4>
<div class="outline-text-4" id="text-sheet-tools">
<p>
I expect to add more functionality in this category over time.  Right now we have one tool, the <a href="#sheet-tools"><code>Separate stamp sheet</code></a> menu option.  This
tool is designed to break up images of stamp sheets into stacks of individual images.  When activated it asks the user how many rows and columns are in the
sheet, and then asks the user to define a "sheet ROI".  This ROI should define the outer edge of where we would cut the stamps (see image below).
</p>


<div id="org1763e4f" class="figure">
<p><img src="PhilaJ-sheetSplitROI.gif" alt="PhilaJ-sheetSplitROI.gif" align="center" width="800" />
</p>
</div>

<p>
The tool will then split the sheet into stamp sized rectangles with boundaries between stamps.  Sometimes these boundaries miss because the original ROI was
improperly positioned.  For this reason, the tool will ask the user if the cut lines are acceptable.  If they are not, then the user is requested to adjust
the sheet ROI.  This process repeats until the user accepts the cut lines.  Then the tool will extract an image for each stamp, and place them all in a single
ImageJ image stack.  Here is what a good set of cut lines look like:
</p>


<div id="org1d236de" class="figure">
<p><img src="PhilaJ-sheetSplitResult.gif" alt="PhilaJ-sheetSplitResult.gif" align="center" width="800" />
</p>
</div>

<p>
One of the best ways to spot plate flaws is to "align" these stamp images, and then flip through the images allowing the natural ability of the human eye to
notice changes.  How do we align the images?  I find it useful to first crop the images so that we just have the designs &#x2013; no perforations.  Do that by
making a rectangular ROI, and then use the "<code>Image -&gt; crop</code>" menu option.  In the image processing field, the problem of aligning images is called "image
registration".  Because this is a very common problem in many fields, ImageJ has several plugins available for the task.  For stamps, I have found "<code>plugins -&gt;
Registration -&gt; linear stack alignment with SIFT</code>" to work very well.
</p>
</div>
</div>
<div id="outline-container-phil-rotate" class="outline-4">
<h4 id="phil-rotate"><span class="section-number-4">4.6.11.</span> Image Rotation</h4>
<div class="outline-text-4" id="text-phil-rotate">
<p>
The <a href="#phil-rotate"><code>Rotate Line to Horizontal</code></a> menu option rotates an image so that the current line ROI will be horizontal.  That is to say, draw a line
on something that should be horizontal in the image (frame line, row of perforations, paper edge, etc..), and use this function to rotate the image.  This
menu function is also bound to the <a href="#keybindings"><code>[1]</code></a> key.
</p>

<p>
The <a href="#phil-rotate"><code>Rotate 90 Degrees Right</code></a> menu option's function is pretty much obvious.  It is also bound to the <a href="#keybindings"><code>[2]</code></a> key.
</p>

<p>
Both of these rotation commands will clear the current overlay.  To redraw it, hit the <a href="#keybindings"><code>[g]</code></a> key.
</p>

<p>
Note that image rotation can make future linear measurements impossible.  Please read the section <a href="#capture-and-scale">Capturing and adjusting properly scaled images</a>.
</p>
</div>
</div>

<div id="outline-container-sub-image" class="outline-4">
<h4 id="sub-image"><span class="section-number-4">4.6.12.</span> Making Images From Selections</h4>
<div class="outline-text-4" id="text-sub-image">
<p>
ImageJ is perfectly capable of creating new images from a selection with "<code>duplicate</code>" command or more explicitly via three steps: 1) "<code>Edit -&gt; Selection -&gt;
To Bounding Box</code>", 2) "<code>Edit -&gt; Copy</code>", 3) "<code>File -&gt; New -&gt; Internal Clipboard</code>".  PhilaJ provides two ways to do something similar.
</p>

<p>
The first is <a href="#sub-image"><code>Selection to image (with scale)</code></a> which simply automates the three steps above <b>and</b> then copies the source image scale to the
new image.  The second is <a href="#sub-image"><code>Selection to JPEG</code></a>, also bound to the uppercase <code>[J]</code> key. This one is a bit more specialized.  It is intended to
immediately save a JPEG of the new image to disk leaving no new image open in ImageJ.  The name for the new JPEG will automatically be annotated with the
coordinates and size of the region from which it was clipped.  This feature is used by the <a href="#coord-tool"><code>Coordinate Tool</code></a> when making box selections &#x2013;
which is mostly how I use it in practice.
</p>
</div>
</div>

<div id="outline-container-overlay-measure" class="outline-4">
<h4 id="overlay-measure"><span class="section-number-4">4.6.13.</span> Overlay/ROI Measure</h4>
<div class="outline-text-4" id="text-overlay-measure">
<p>
The menu item <a href="#overlay-measure"><code>Overlay/ROI Measure</code></a>, also bound to the uppercase <a href="#keybindings"><code>[M]</code></a> key, is intended to largely replace and extend the
behavior of the built in "<code>Measure</code>" function bound to the lowercase <code>[m]</code> key.
</p>

<p>
<a href="#overlay-measure"><code>Overlay/ROI Measure</code></a> preforms a sequence of actions.  First it saves the measured ROI in the ROI Manager with a name of
"<code>philMeasured</code>" &#x2013; if an ROI already exists with that name, then it will be removed first.  Next it calls the built in "<code>Measure</code>" function &#x2013; note the name
of the ROI when measured will be the name the ROI had when <a href="#overlay-measure"><code>Overlay/ROI Measure</code></a> was called &#x2013; <b>not</b> "<code>philMeasured</code>".  Lastly
<a href="#overlay-measure"><code>Overlay/ROI Measure</code></a> will preform an overlay specific action for the following overlays:
</p>

<ul class="org-ul">
<li><a href="#dynamic-perf-gauge"><code>Dynamic Perforation Gauge</code></a></li>
<li><a href="#pos-finder"><code>Position Finder</code></a></li>
<li><a href="#grill-tool"><code>Grill</code></a></li>
</ul>
</div>
</div>
<div id="outline-container-measure-offset" class="outline-4">
<h4 id="measure-offset"><span class="section-number-4">4.6.14.</span> Measuring ROI Offsets</h4>
<div class="outline-text-4" id="text-measure-offset">
<p>
ROI offsets are closely related to centering, but are more about things that should be in a particular place but are not.  For example, if a press comes down
on a sheet twice in a perfect world, it would hit the same place.  But when they don't we can see two impressions with one offset from the other. As an
example, consider the following image.  The popup in the middle is what you get when you use the <a href="#measure-offset"><code>Offset Between ROIs</code></a> tool, and select
the two deign frames.
</p>


<div id="org944703f" class="figure">
<p><img src="PhilaJ-meas-offset.gif" alt="PhilaJ-meas-offset.gif" align="center" width="800px" />
</p>
</div>

<p>
Note the offsets are measured in terms of the distance between the upper left of each ROI's <a href="#bb-hr-roi">bounding box</a>.
</p>
</div>
</div>

<div id="outline-container-load-save-magic" class="outline-4">
<h4 id="load-save-magic"><span class="section-number-4">4.6.15.</span> PhilaJ Image Load &amp; Save</h4>
<div class="outline-text-4" id="text-load-save-magic">
<p>
The PhilaJ <a href="#load-save-magic"><code>Load image &amp; ROI sidecar.  Attempt to set Scale.</code></a> menu option, also bound to lowercase <a href="#keybindings"><code>[o]</code></a>, cause a
sequence of actions: first an image is loaded, then ROIs are loaded via <a href="#roi-sidecars"><code>Load ROIs from PhilaJ sidecar file</code></a>, and then PhilaJ attempts
to set the image scale using the following sequence of steps (stopping when one of them works):
</p>

<ul class="org-ul">
<li>If ImageJ set the scale automatically, then PhilaJ will attempt to covert the scale to millimeters 
via <a href="#set-scale-convert"><code>Convert image scale units to mm</code></a>.  This most commonly occurs when ImageJ uses an embedded TIFF DPI tag 
created automatically by a document scanner.</li>
<li>Next it attempts to use <a href="#set-scale-filename"><code>Set scale from DPI file name</code></a></li>
<li>Next it attempts to use <a href="#scale-roi"><code>Set scale from scale ROI</code></a></li>
<li>Lastly it will attempt to use <a href="#scale-rpi"><code>Set Scale for Stereo Microscope Photograph</code></a> if the image is located in the RPI image directory (normally
"<code>$HOME/Pictures/pi-cam</code>").</li>
</ul>

<p>
The PhilaJ <a href="#load-save-magic"><code>Save image &amp; ROI sidecar</code></a> menu option, also bound to lowercase <a href="#keybindings"><code>[s]</code></a>, saves the file, and an
<a href="#roi-sidecars">ROI sidecar file</a> if the ROI manager is non-empty.  Note that PhilaJ always saves a file as a <code>PNG</code> or <code>TIFF</code> file &#x2013; a <code>PNG</code> if the file is
a simple image with one slice and a <code>TIFF</code> otherwise.
</p>

<p>
The <a href="#load-save-magic"><code>SaveAs image &amp; ROI sidecar</code></a>, bound to uppercase <a href="#keybindings"><code>[S]</code></a>, is similar except it allows the user the change the
filename first.
</p>
</div>
</div>

<div id="outline-container-roi-sidecars" class="outline-4">
<h4 id="roi-sidecars"><span class="section-number-4">4.6.16.</span> ROI Sidecars</h4>
<div class="outline-text-4" id="text-roi-sidecars">
<p>
PhilaJ associates a "sidecar" file containing ROIs with each image file.  Essentially PhilaJ expects to find ROIs associated with an image file saved off in
another file of the same name and an extension of "<code>.roi.zip</code>".  For example, if your image file was named "<code>foo.png</code>", then the sidecar would be named
"<code>foo.roi.zip</code>".
</p>

<p>
We can save and load sidecar files for the currently active image with the menu options <a href="#roi-sidecars"><code>Load ROIs from PhilaJ sidecar file</code></a> &amp;
<a href="#roi-sidecars"><code>Save ROIs to PhilaJ ROI sidecar file</code></a>..
</p>
</div>
</div>

<div id="outline-container-note-sidecars" class="outline-4">
<h4 id="note-sidecars"><span class="section-number-4">4.6.17.</span> Note Sidecars</h4>
<div class="outline-text-4" id="text-note-sidecars">
<p>
Similar to <a href="#roi-sidecars"><code>ROI Sidecars</code></a>, PhilaJ can load a text file associated with an image via the <a href="#note-sidecars"><code>Load Notes from PhilaJ sidecar
file</code></a> menu entry.  
</p>

<p>
Note sidecars are not as integrated into PhilaJ as are <a href="#roi-sidecars"><code>ROI Sidecars</code></a>.  These files are not automatically loaded by
<a href="#load-save-magic"><code>Load image &amp; ROI sidecar.  Attempt to set Scale.</code></a>.  They are also not automatically saved by <a href="#load-save-magic"><code>Save image &amp; ROI
sidecar</code></a> or <a href="#load-save-magic"><code>SaveAs image &amp; ROI sidecar</code></a>.  Finally, they are not automatically renamed when the image is renamed.
</p>
</div>
</div>

<div id="outline-container-set-scale-convert" class="outline-4">
<h4 id="set-scale-convert"><span class="section-number-4">4.6.18.</span> Convert image scale units to mm</h4>
<div class="outline-text-4" id="text-set-scale-convert">
<p>
The <a href="#set-scale-convert"><code>Convert image scale units to mm</code></a> menu option attempts to convert the current image scale units to millimeters for PhilaJ. For
example, if an image scale was specified in DPI via an embedded TIFF tag, this will convert it to millimeters.  It only knows about the most commonly used
length units in philately:
</p>

<ul class="org-ul">
<li>mils &#x2013; thousandths of an inch</li>
<li>inches</li>
<li>centimeters</li>
<li>meters</li>
<li>micrometers</li>
</ul>
</div>
</div>

<div id="outline-container-scale-image-scale" class="outline-4">
<h4 id="scale-image-scale"><span class="section-number-4">4.6.19.</span> Image Resize To Scale</h4>
<div class="outline-text-4" id="text-scale-image-scale">
<p>
PhilaJ has two tools that can resize an image with the end goal of changing the image scale.  In both cases, an image with different horizontal &amp; vertical
scales will be resized so that the pixels are as square as possible.  The difference is in <b>how</b> the resize is preformed.
</p>

<p>
The first menu option is <a href="#scale-image-scale"><code>Shrink image to make pixels square</code></a>.  This command only shrinks the image, and then only horizontally or
vertically &#x2013; not both.  The second option is <a href="#scale-image-scale"><code>Resize image to target DPI</code></a>.  This one resizes the image to hit a target DPI.  In doing
so it might shrink or grow the image, and it might resize both horizontally &amp; vertically.  The first option minimizes both distortion and data loss.  It is
the best choice for precision measurement.  The second option is more useful when resizing an image so that it may be printed/published at a desired
size.
</p>

<p>
It is important to make pixels square before an image is rotated.  Failure to do so will make future linear measurements impossible. Please read the section
<a href="#capture-and-scale">Capturing and adjusting properly scaled images</a>.
</p>
</div>
</div>

<div id="outline-container-scale-roi" class="outline-4">
<h4 id="scale-roi"><span class="section-number-4">4.6.20.</span> Scale ROIs</h4>
<div class="outline-text-4" id="text-scale-roi">
<p>
PhilaJ contains two commands that work directly with a special ROI to set or save image scale:
</p>

<ul class="org-ul">
<li><a href="#scale-roi"><code>Set scale from scale ROI</code></a></li>
<li><a href="#scale-roi"><code>Create scale ROI and add it to the ROI manager</code></a></li>
</ul>

<p>
While these can be called via the scale menu, the first is automatically called when using the PhilaJ file open command (The <a href="#keybindings"><code>[o]</code></a> key).
</p>

<p>
Scale ROIs have a special format for the name: "<code>scale_&lt;NUMBER&gt;mm</code>"
</p>

<p>
If the scale ROI is a line, then "<code>NUMBER</code>" is its length in millimeters.  If it is a rectangle ROI, then "<code>NUMBER</code>" is its width in millimeters.
</p>

<p>
When the scale ROI is a line, then image pixels are assumed to be square.  When it is a rectangle, the height of the rectangle is used to set
the pixel aspect ratio.
</p>

<p>
PhilaJ can <b>create</b> a rectangular ROI for a scaled image and place that ROI in the ROI manager.  PhilaJ will <b>always</b> create rectangular scale ROIs even when
the pixel aspect ratio is 1.
</p>
</div>
</div>

<div id="outline-container-scale-alt" class="outline-4">
<h4 id="scale-alt"><span class="section-number-4">4.6.21.</span> Alternate interfaces to the ImageJ set scale command</h4>
<div class="outline-text-4" id="text-scale-alt">
<p>
The built in ImageJ set scale dialog may be accessed via the PhilaJ scale menu using the option <a href="#scale-alt"><code>Set Scale via standard ImageJ dialog</code></a>.  In
addition, this menu provides four other interfaces to the same command that might be more directly useful for stamp images.
</p>

<ul class="org-ul">
<li><a href="#scale-alt"><code>Set Scale 1D</code></a> <br />
This menu option provides a simple way to enter known distances in pixels and millimeters, and sets the scale.  The distance in pixels can be
prepopulated from the distance of a line ROI if one is active when the menu is selected.  This is much like the built in scale command, but forces the
use of millimeters.</li>
<li><a href="#scale-alt"><code>Set Scale 1D from measurement results table</code></a> <br />
This menu option works just like the previous except it takes the distance in pixels from the last measured value in the measurement results table.</li>
<li><a href="#scale-alt"><code>Set Scale 2D</code></a> <br />
This menu option provides a more direct way to set the scale for an image with different horizontal &amp; vertical scales.  Instead of asking for a scale
ratio like the built in command, it requests known distances in pixels &amp; millimeters in both the horizontal and vertical direction.  This is usually a
simpler for philatelic work because we are using 1) a scanner with known horizontal &amp; vertical DPI, or 2) we are using a right angle measurement scale in
the photographic field.</li>
<li><a href="#scale-alt"><code>Set Scale 2D from measurement results table</code></a> <br />
This menu option works just like the previous, but it takes both the horizontal (measurement #1) &amp; vertical (measurement #2) distance distance in pixels
from the last two measurements in the measurement results table.  When using a right angle measurement scale, the typical procedure is to draw the
vertical scale ROI, hit <a href="#keybindings"><code>[m]</code></a>, draw the horizontal scale ROI, hit <a href="#keybindings"><code>[m]</code></a>, and then invoke this function.</li>
</ul>

<p>
Note the default distance in millimeters for all of these options is \(50\,\mathrm{mm}\) because I use \(50\,\mathrm{mm}\) glass scales graduated to
\(\frac{1}{10}\,\mathrm{mm}\) for both my scanner and microscope.
</p>
</div>
</div>

<div id="outline-container-set-scale-dpi" class="outline-4">
<h4 id="set-scale-dpi"><span class="section-number-4">4.6.22.</span> Set scale via DPI</h4>
<div class="outline-text-4" id="text-set-scale-dpi">
<p>
The <a href="#set-scale-dpi"><code>Set scale for DPI</code></a> allows the user to set the image scale directly via a DPI value.  This value is converted into millimeters
automatically.  Modern scanners frequently have different DPIs horizontally &amp; vertically, and that is where the <a href="#set-scale-dpi"><code>Set Scale for Hoiz &amp; Vert
DPI</code></a> menu option comes in.
</p>

<p>
Lastly, several common DPIs may be set via a handful of options at the top of the scale menu:
</p>

<ul class="org-ul">
<li><a href="#set-scale-dpi"><code>Set scale for DPI: 2410x2398</code></a>   &#x2013; This odd DPI is what I get at the center of the platen on my Epson scanner. ;)</li>
<li><a href="#set-scale-dpi"><code>Set scale for DPI: 2400</code></a></li>
<li><a href="#set-scale-dpi"><code>Set scale for DPI: 1200</code></a></li>
<li><a href="#set-scale-dpi"><code>Set scale for DPI: 600</code></a></li>
<li><a href="#set-scale-dpi"><code>Set scale for DPI: 300</code></a></li>
</ul>
</div>
</div>

<div id="outline-container-set-scale-filename" class="outline-4">
<h4 id="set-scale-filename"><span class="section-number-4">4.6.23.</span> Set scale from DPI file name</h4>
<div class="outline-text-4" id="text-set-scale-filename">
<p>
The <a href="#set-scale-filename"><code>Set scale from DPI file name</code></a> menu option extracts DPI information encoded in the filename of the current image.  This is
probably best explained via examples:
</p>

<ul class="org-ul">
<li>"<code>foo_2400dpi.jpg</code>" &#x2013; Set the DPI to 2400</li>
<li>"<code>foo_2400.123dpi.jpg</code>" &#x2013; Set the DPI to 2400.123 (that is to say, the DPI need not be a whole number)</li>
<li>"<code>foo_2300vdpi_2500hdpi.jpg</code>" &#x2013; Set the <b>vertical</b> DPI to 2300 and the <b>horizontal</b> DPI to 2500.</li>
</ul>

<p>
When loaded via the PhilaJ <a href="#load-save-magic"><code>Load image &amp; ROI sidecar.  Attempt to set Scale.</code></a> command, a DPI encoded in a filename like this will
automatically be used to set the image scale.  Thus this command is most useful when an image has been loaded in another way &#x2013; like via the "<code>file -&gt; open</code>"
command in the main ImageJ menu.
</p>
</div>
</div>

<div id="outline-container-phil-data" class="outline-4">
<h4 id="phil-data"><span class="section-number-4">4.6.24.</span> Philatelic Data</h4>
<div class="outline-text-4" id="text-phil-data">
<p>
Some of the data PhilaJ houses for doing computations can come in handy for the humans using the tool.
</p>

<p>
The <a href="#phil-data"><code>Kiusalas Table</code></a> menu item will display a table of US Kiusalas values, the value reported in the Scott Catalog, and the standard
perforation measurement to four digits.
</p>


<div id="org18aa62a" class="figure">
<p><img src="PhilaJ-data-usKSP.gif" alt="PhilaJ-data-usKSP.gif" align="center" width="400" />
</p>
</div>

<p>
The <a href="#phil-data"><code>Grill Table</code></a> menu item will display a table of US grill characteristics. 
</p>


<div id="org2342a39" class="figure">
<p><img src="PhilaJ-data-usGrills.gif" alt="PhilaJ-data-usGrills.gif" align="center" width="800" />
</p>
</div>
</div>
</div>

<div id="outline-container-phil-units" class="outline-4">
<h4 id="phil-units"><span class="section-number-4">4.6.25.</span> Philatelic Unit Conversions</h4>
<div class="outline-text-4" id="text-phil-units">
<p>
PhilaJ can convert a few units philatelists frequently encounter.  Perforations may be converted between "hole gap in thousandths of an inch" (i.e. Kiusalas) and "holes
per 2cm" (i.e. what is in most catalogs) via:
</p>

<ul class="org-ul">
<li><a href="#phil-units"><code>Convert Kiusalas to Perforations per 2cm</code></a></li>
<li><a href="#phil-units"><code>Convert Perforations per 2cm to Kiusalas</code></a></li>
</ul>

<p>
These functions pop up a dialog box asking the user to enter the value to convert, and then pop up a window with the answer.
</p>

<p>
Much of PhilaJ's functionality is centered around linear distances measured in millimeters; however, sometimes we get values in other units.  The
<a href="#phil-units"><code>Convert length to millimeters</code></a> menu item allows one to convert various other units to millimeters.
</p>

<p>
Lastly the <a href="#phil-units"><code>Convert Distance to Perforation Measurement</code></a> menu item "converts" distance into "holes per 2cm".  This isn't really a straight up
unit conversion like the other commands documented in this section; however, I include it in the menu because some older catalogs measure perforations as a
count over a distance other than 2cm.  The idea is that you have \(N\) perforation holes, and measure the distance from center to center (or edge to edge) for
the holes, then you can compute the perforation value in standard units.  Like the previous functions, this one will pop up a dialog box asking for distance
and hole count.  If you have an active line ROI when the menu is selected, then the length of the line will be used to prepopulate the distance value.  If
that line ROI happens to be one that was previously created by the <a href="#dynamic-perf-gauge"><code>Dynamic Perforation Gauge</code></a>, then the number of holes will also be
prepopulated.  The results window provides standard perforation and Kiusalas units.
</p>


<div id="orgc55d608" class="figure">
<p><img src="PhilaJ-compute-d2p.gif" alt="PhilaJ-compute-d2p.gif" align="center" width="400" />
</p>
</div>
</div>
</div>

<div id="outline-container-scale-report" class="outline-4">
<h4 id="scale-report"><span class="section-number-4">4.6.26.</span> Scale Report</h4>
<div class="outline-text-4" id="text-scale-report">
<p>
The <a href="#scale-report"><code>Scale Report</code></a> menu option produces a short report in a popup regarding the current image scale.  This is a handy report because it
bridges the gap between the various ways image scales are usually reported.  Many times a US philatelist will be working in DPI while a colleague in the EU
may be working in PPMM.  Another common scenario is having some images captured via a digital video camera or microscope camera where scale is frequently
expressed as pixel size in \(\mu\mathrm{m}\) and other images of the same specimen from a document scanner calibrated in DPI.
</p>


<div id="org5faa397" class="figure">
<p><img src="PhilaJ-scale-report.gif" alt="PhilaJ-scale-report.gif" align="center" width="400" />
</p>
</div>
</div>
</div>

<div id="outline-container-bulk-processing" class="outline-4">
<h4 id="bulk-processing"><span class="section-number-4">4.6.27.</span> Bulk Processing Images</h4>
<div class="outline-text-4" id="text-bulk-processing">
<p>
Philatelists frequently have a great many scans or captures to deal with.  Be it a marathon album scanning session or a detailed analysis of a single,
valuable specimen.  
</p>

<p>
PhilaJ provides a semi-automated method to scale for square pixels, rotate, crop, save, and create a thumbnail file.  I say semi-automated in that as PhilaJ
processes each image the end user is required to draw a line for a rotation to horizontal and draw a rectangle for the final crop.  This routine is accessed
via the <a href="#bulk-processing"><code>Process a directory of scans</code></a> menu option.
</p>

<p>
Note: Other software can do this stuff in a fully, or almost fully, automated way.  The only issue with these fully automated solutions is that most of them do
not make image size adjustments to square the pixels before they rotate the images into alignment (See the section <a href="#capture-and-scale">Capturing and
adjusting properly scaled images</a> for more).  That said, if you are just doing a bulk album scan, then these tools are well worth the time to acquire and learn
how to use.
</p>
</div>
</div>

<div id="outline-container-cleaning-up-windows-n-files" class="outline-4">
<h4 id="cleaning-up-windows-n-files"><span class="section-number-4">4.6.28.</span> Cleanup Windows and Files</h4>
<div class="outline-text-4" id="text-cleaning-up-windows-n-files">
<p>
PhilaJ can pop up quite a few windows, and when loading a new image most of those windows won't be helpful.  Closing all those windows by clicking on the
close buttons is a pain, so PhilaJ provides a few helpful menu items:
</p>

<ul class="org-ul">
<li><a href="#cleaning-up-windows-n-files"><code>Close PhilaJ Windows</code></a></li>
<li><a href="#cleaning-up-windows-n-files"><code>Close PhilaJ &amp; Related Windows</code></a></li>
<li><a href="#cleaning-up-windows-n-files"><code>Close Image, PhilaJ, &amp; Related Windows</code></a></li>
</ul>

<p>
Frequently we don't just want to close the windows, we want to also <b>delete the image file</b> at the same time.  This is very common with microscope images
that we snapped for a quick analysis.  In these cases, the following menu options may be useful:
</p>

<ul class="org-ul">
<li><a href="#cleaning-up-windows-n-files"><code>Delete current image file</code></a></li>
<li><a href="#cleaning-up-windows-n-files"><code>Delete current image file &amp; close image window</code></a></li>
<li><a href="#cleaning-up-windows-n-files"><code>Delete current image file &amp; close associated windows</code></a></li>
</ul>
</div>
</div>

<div id="outline-container-roi-name-tools" class="outline-4">
<h4 id="roi-name-tools"><span class="section-number-4">4.6.29.</span> Bulk ROI Rename</h4>
<div class="outline-text-4" id="text-roi-name-tools">
<p>
The <a href="#roi-name-tools"><code>Bulk ROI Rename</code></a> menu option is a powerful way to rename ROIs; however, it can can be quite dangerous.  I strongly suggest saving
the ROI Manager contents first.  This tool asks the user for a search and replacement string.  It then replaces every occurrence in the <b>names</b> of the ROIs in
the ROI Manager.
</p>
</div>
</div>

<div id="outline-container-roi-cleanup" class="outline-4">
<h4 id="roi-cleanup"><span class="section-number-4">4.6.30.</span> Cleanup The ROI Manager</h4>
<div class="outline-text-4" id="text-roi-cleanup">
<p>
The menu option <a href="#roi-cleanup"><code>Clean up ROI list</code></a> preforms several actions:
</p>

<ul class="org-ul">
<li>Rename old style ROI names.  Older versions of PhilaJ used different standard ROI names.  This tool transforms the old style names into the new style names.</li>
<li>Delete any ROIs with a duplicate name &#x2013; leaving just one ROI with any given name.</li>
<li>Delete any margin ROI with no associated design &amp; paper ROIs.</li>
<li>Delete any BB ROI without a corresponding ROI for which it could be the bounding box</li>
<li>Delete "<code>pfHole</code>" ROIs without matching "<code>pfLine</code>" ROIs</li>
<li>Regenerate the "<code>ALL</code>" ROI</li>
<li>Pop up a window with a report of all the changes.</li>
</ul>

<p>
I suggest saving the ROI Manager contents first.  That way you can undo the cleanup.
</p>
</div>
</div>
</div>

<div id="outline-container-capture-and-scale" class="outline-3">
<h3 id="capture-and-scale"><span class="section-number-3">4.7.</span> Capturing and adjusting properly scaled images</h3>
<div class="outline-text-3" id="text-capture-and-scale">
<p>
Camera digital image sensors have very stable pixel sizes across the entire frame.  This makes it a simple matter to calculate the theoretical horizontal &amp;
vertical image scales, and gives us some trust in the consistency of scales we directly measure.  Most dedicated microscope cameras have square pixel sensors,
so images will have the same scale horizontally &amp; vertically.  Note I said "theoretical" above.  Lens distortions and improper specimen placement can cause
very serious issues.  We can't do much about lens distortion except try to put our stamps in the optical sweet spot &#x2013; usually the center third of the lens.
We can do something about specimen placement.  It is critically important that the stamp and image sensor are parallel to each other.  If not then perspective
distortion will make measurements impossible.  Using a stereo microscope on a microscope base makes this much less difficult because they are mechanically
designed to keep the stage and lenses parallel.  Many digital microscopes are not so designed, and need to be aligned with the surface upon which stamps will
be placed.  One simple way to align them is to take photographs of a something known to be perfectly square (like a quilting grid or photographic target), and
then adjust the microscope until the captured image gives you a perfect square.
</p>

<p>
While document scanners don't have the complexities of specimen placement to deal with, they do provide unique challenges.  Even if one uses a single
resolution mode, most document scanners don't have quite the same DPI horizontally and vertically.  In fact, many flat bed scanners have some variation in DPI
across the platten.  For example my scanner's DPI horizontally varies about 30 DPI across the platten, but only varies a couple DPI vertically.  Much like
putting a stamp in the sweet spot of a camera lens, I try to always scan stamps in the middle third of my flatbed scanner where the DPI is about 2410x2398.
This isn't much of a difference, but it can become an issue when making fine measurements (perforation hole sizes, perforation gaps, curved vs flat plate
prints, etc&#x2026;).
</p>

<p>
When using a document scanner you are almost always forced to deal with images with different horizontal &amp; vertical scales.  If you are unlucky and have
a microscope camera with non-square pixels, then you will need to deal with them too.  Because such images are so common, ImageJ provides direct support for
them.  Unfortunately such images can't be rotated without destroying our ability to make linear measurements.
</p>

<p>
But I need to rotate my images!  What do I do?
</p>

<p>
The simplest answer is to adjust the image size so that the pixels become square.  This can be done manually in ImageJ, but PhilaJ provides a couple handy
functions for the task: <a href="#scale-image-scale"><code>Shrink image to make pixels square</code></a> and <a href="#scale-image-scale"><code>Resize image to target DPI</code></a>.
</p>
</div>
</div>

<div id="outline-container-spec-gauge-list" class="outline-3">
<h3 id="spec-gauge-list"><span class="section-number-3">4.8.</span> Available Specialist gauges and presets</h3>
<div class="outline-text-3" id="text-spec-gauge-list">
<dl class="org-dl">
<dt>Updated Kiusalas Perforation Gauge</dt><dd>I have a high degree of confidence in this gauge, and think I have both the frequency &amp; hole sizes correct. This one
includeds a row for 72.5.</dd>
<dt>Traditional Kiusalas Perforation</dt><dd>I have a high degree of confidence in this gauge, and think I have both the frequency &amp; hole sizes correct.</dd>
<dt>Liberty Issue Perforation Gauge</dt><dd>Right now the gaps are the nearest Kiusalas value, and the hole sizes are based on values from articles.  Unfortunately
this isn't quite right.  The hole sizes vary a bit between wet vs dry printings and the gaps between the large &amp; small hole varieties is a tiny bit
different.  So be careful when using it.  I hope to someday make a better gauge based on measurements of my extensive Liberty collection.</dd>
<dt>BARI Wolf Issue Perforation Gauge</dt><dd>This gauge is based on measurements of my personal collection.  I'm still refining this gauge as I learn more about
this issue, but the gauge is pretty good at this point.</dd>
<dt>Canadian Kiusalas Perforation Gauge</dt><dd>The gaps are correct, but the hole diameters on this gauge are completely wrong &#x2013; I just set them to 1mm.  If you
know what they should be, then please contact me!</dd>
<dt>AMG AM Post</dt><dd>This gauge is based on a <b>very small</b> set of measurements of these issues, and needs more work.</dd>
</dl>
</div>
</div>

<div id="outline-container-org4d53313" class="outline-3">
<h3 id="org4d53313"><span class="section-number-3">4.9.</span> A Note About The Thirkell Position Finder</h3>
<div class="outline-text-3" id="text-4-9">
<p>
The <a href="#pos-finder"><code>Position Finder</code></a> tool provides a minimal level of support for the way the Thirkell Position Finder is used by experts (the addition of
negative &amp; fractional grid coordinates, and millimeter coordinate offsets).  Frankly I'm disinclined to extend support beyond the basic because the current
implementation meets most people's needs, and I feel the PhilaJ <a href="#coord-tool"><code>Coordinate Tool</code></a> is a better solution for more complex requirements.
</p>

<p>
I'm not saying the Thirkell Position Finder has anything wrong with it.  In fact, the Thirkell Position Finder is a marvelous tool for manually documenting
and locating plate flaws.  The frame lines provide an easy way to align the guide, the 3mm grid system provides a good reference for the eye to follow, the mm
scale allows one to gain millimeter accuracy, and the letter axis eliminates errors in notation.  Most of the time a simple coordinate is all you need to
communicate a location except for a couple cases. Consider the following clip from the upper left hand of an AM Post issue.
</p>


<div id="orga734719" class="figure">
<p><img src="speckOnEdge.jpg" alt="speckOnEdge.jpg" align="center" width="400" />
</p>
</div>

<p>
Note the two plate flaws: 1) In the margin, and 2) on the frame line.  These kinds of flaws require one to be creative in the use of the Thirkell Position
Finder.  These "edge cases", pun intended, are the reasons experts have extended the Thirkell with negative and fractional grids.  That said, most people
avoid the technical stuff and just use phrases like "To the left of position A1", "On the right edge of A1", or "On the grid line between B1 &amp; B2".  While all
of these solutions work perfectly for <b>humans</b> communicating to other <b>humans</b>, they fall short when trying to document coordinates in a uniform way in
digital form.
</p>

<p>
Much of the design of the Thirkell Position Finder is about overcoming limitations of human dexterity and visual acuity &#x2013; the 3mm guide grid for example.
I think in a world of modern digital image analysis, it is simplest to do away with the Thirkell altogether and simply locate positions using the <b>signed</b>
distance to the right and below the upper left corner of the design bounding box.  That is, do precisely what the Thirkell does, but get rid of the visual
guides we no longer need and allow negative numbers. This is the idea behind the <a href="#coord-tool"><code>Coordinate Tool</code></a> in PhilaJ.
</p>
</div>
</div>

<div id="outline-container-org8bf1f5e" class="outline-3">
<h3 id="org8bf1f5e"><span class="section-number-3">4.10.</span> ROIs</h3>
<div class="outline-text-3" id="text-4-10">
<p>
Note: This entire section can be ignored by most PhilaJ users&#x2026;
</p>

<p>
ROIs play a central role in PhilaJ (and in ImageJ in general).  PhilaJ has adopted standard names for several commonly philatelic use cases.
</p>
</div>

<div id="outline-container-org64ba898" class="outline-4">
<h4 id="org64ba898"><span class="section-number-4">4.10.1.</span> Named ROIs</h4>
<div class="outline-text-4" id="text-4-10-1">
<table border="2 solid #ccc" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" align="center">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">ROI</th>
<th scope="col" class="org-left">Type</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>coilEdge&lt;B/L/R/T&gt;</code></td>
<td class="org-left">Line</td>
<td class="org-left">Straight edge of a coil stamp</td>
</tr>

<tr>
<td class="org-left"><code>design[_&lt;SID&gt;][-&lt;SFX&gt;]</code></td>
<td class="org-left">Any area</td>
<td class="org-left">Design boundaries.</td>
</tr>

<tr>
<td class="org-left"><code>fault[_&lt;SID&gt;][-&lt;SFX&gt;]</code></td>
<td class="org-left">Any</td>
<td class="org-left">Fault locations</td>
</tr>

<tr>
<td class="org-left"><code>grillPts[_&lt;SID&gt;][-&lt;SFX&gt;]</code></td>
<td class="org-left">Points</td>
<td class="org-left">Identifies grill points</td>
</tr>

<tr>
<td class="org-left"><code>grill[_&lt;SID&gt;][-&lt;SFX&gt;]</code></td>
<td class="org-left">Rectangle</td>
<td class="org-left">Grill boundaries.</td>
</tr>

<tr>
<td class="org-left"><code>idFact[_&lt;SID&gt;][-&lt;SFX&gt;]</code></td>
<td class="org-left">Any</td>
<td class="org-left">Identifying factors &#x2013; like a plate artifact</td>
</tr>

<tr>
<td class="org-left"><code>margin&lt;B/L/R/T&gt;[_&lt;SID&gt;][-&lt;SFX&gt;]</code></td>
<td class="org-left">Rectangle</td>
<td class="org-left">Bottom/Left/Right/Top stamp margin</td>
</tr>

<tr>
<td class="org-left"><code>outside_edges</code></td>
<td class="org-left">Any Area</td>
<td class="org-left">Outer paper boundaries</td>
</tr>

<tr>
<td class="org-left"><code>overprint[_&lt;SID&gt;][-&lt;SFX&gt;]</code></td>
<td class="org-left">Any area</td>
<td class="org-left">Overlay</td>
</tr>

<tr>
<td class="org-left"><code>paper[_&lt;SID&gt;]</code></td>
<td class="org-left">Any area</td>
<td class="org-left">Paper boundaries inside perforations.</td>
</tr>

<tr>
<td class="org-left"><code>pfHole&lt;NN&gt;&lt;MM&gt;_&lt;SFX&gt;</code></td>
<td class="org-left">Circle</td>
<td class="org-left">Perforation hole associated with <code>pfLine&lt;NN&gt;_&lt;SFX&gt;</code>.</td>
</tr>

<tr>
<td class="org-left"><code>pfLine&lt;NN&gt;_&lt;SFX&gt;</code></td>
<td class="org-left">Line</td>
<td class="org-left">Line of perforations.  <code>&lt;NN&gt;</code> is the perforation count.</td>
</tr>

<tr>
<td class="org-left"><code>pf[_&lt;SID&gt;][-&lt;SFX&gt;]</code></td>
<td class="org-left">Circle</td>
<td class="org-left">Plate flaw locations</td>
</tr>

<tr>
<td class="org-left"><code>pmark[_&lt;SID&gt;][-&lt;SFX&gt;]</code></td>
<td class="org-left">Any area</td>
<td class="org-left">Postmark</td>
</tr>

<tr>
<td class="org-left"><code>pn_&lt;N&gt;</code></td>
<td class="org-left">Rectangle</td>
<td class="org-left">Rectangle bounding the plate number</td>
</tr>

<tr>
<td class="org-left"><code>pt_&lt;TAG&gt;_&lt;N&gt;</code></td>
<td class="org-left">Point</td>
<td class="org-left">Points created by coordinate tool.</td>
</tr>

<tr>
<td class="org-left"><code>scale_&lt;X&gt;mm</code></td>
<td class="org-left">Rectangle</td>
<td class="org-left">Used to set image scale (<code>&lt;X&gt;</code> is the scale)</td>
</tr>

<tr>
<td class="org-left"><code>stampBdry[_&lt;SID&gt;]</code></td>
<td class="org-left">Any Area</td>
<td class="org-left">Outer paper boundaries of a single stamp</td>
</tr>

<tr>
<td class="org-left"><code>wmark[_&lt;SID&gt;][-&lt;SFX&gt;]</code></td>
<td class="org-left">Any area</td>
<td class="org-left">Watermarks</td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-orgd2267b9" class="outline-5">
<h5 id="orgd2267b9"><span class="section-number-5">4.10.1.1.</span> Notation</h5>
<div class="outline-text-5" id="text-4-10-1-1">
<ul class="org-ul">
<li>Items in square brackets <b>are not</b> required, but items in angle brackets <b>are</b> required.
<ul class="org-ul">
<li>Example 1: <code>pfLine&lt;NN&gt;_&lt;SFX&gt;</code> 
<ul class="org-ul">
<li>GOOD: <code>pfLine12_foo</code></li>
<li>BAD:  <code>pfLine_foo</code>, <code>pfLine12</code>, &amp; <code>pfLine</code></li>
</ul></li>
<li>Example 2: <code>design[_&lt;SID&gt;][-&lt;SFX&gt;]</code>
<ul class="org-ul">
<li>GOOD: <code>design_foo-bar</code>, <code>design_foo</code>, <code>design-bar</code>, <code>design</code></li>
<li>BAD: <code>design_</code> &#x2013; i.e. if you have the "<code>_</code>" you must have the "<code>SID</code>" too!</li>
</ul></li>
</ul></li>
<li>Items separated by hashes are mutually exclusive options
<ul class="org-ul">
<li>Example: <code>coilEdge&lt;B/L/R/T&gt;</code>
<ul class="org-ul">
<li>GOOD: <code>coilEdgeB</code>, <code>coilEdgeL</code>, <code>coilEdgeR</code>, <code>coilEdgeT</code></li>
<li>BAD: <code>coilEdge</code> &amp; <code>coilEdgeBL</code></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-roi-name-components" class="outline-5">
<h5 id="roi-name-components"><span class="section-number-5">4.10.1.2.</span> About ROI Name Components</h5>
<div class="outline-text-5" id="text-roi-name-components">
<ul class="org-ul">
<li><code>&lt;B/L/R/T&gt;</code> - Used to indicate side (Bottom, Left, Right, Top)</li>
<li><code>&lt;NN&gt;</code> &amp; <code>&lt;MM&gt;</code> - zero padded integers &#x2013; i.e. "<code>01</code>" but not "<code>1</code>"</li>
<li><code>&lt;SID&gt;</code> - Used to identify the stamp an ROI is associated with.
<ul class="org-ul">
<li>Rules:
<ul class="org-ul">
<li>Should be alphanumeric (letters and numbers)</li>
<li>Must not contain a dash ("<code>-</code>")</li>
</ul></li>
<li>Recommendations
<ul class="org-ul">
<li>Blocks/sheets: Integers starting with 1 at the upper left and going left to right &amp; top to bottom.</li>
<li>For large multiples, zero pad the integer so the SID integers are all the same width and thus sort correctly</li>
<li>For pairs use <code>L</code> (Left) &amp; <code>R</code> (Right) or <code>T</code> (Top) &amp; <code>B</code> (Bottom)</li>
</ul></li>
</ul></li>
<li><code>&lt;SFX&gt;</code> - Used to differentiate an ROI from others with the same name
<ul class="org-ul">
<li>Rules:
<ul class="org-ul">
<li>Should be alphanumeric (letters and numbers)</li>
</ul></li>
<li>Examples
<ul class="org-ul">
<li>"<code>design_1-center</code>" &amp; "<code>design_1-frame</code>" might be use for a classic, bi-color US stamp</li>
<li>"<code>design_1-A</code>" &amp; "<code>design_1-B</code>" might be use for a stamp with a double impression</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org1a0a34d" class="outline-5">
<h5 id="org1a0a34d"><span class="section-number-5">4.10.1.3.</span> Some Component Recommendations</h5>
<div class="outline-text-5" id="text-4-10-1-3">
<ul class="org-ul">
<li>For perforation ROIs (<code>pfHole&lt;NN&gt;&lt;MM&gt;_&lt;SFX&gt;</code> &amp; <code>pfLine&lt;NN&gt;_&lt;SFX&gt;</code>)
<ul class="org-ul">
<li>For single stamps I normally use: <code>T (Top)</code>, <code>B</code> (Bottom), <code>L</code> (Left), &amp; <code>R</code> (Right) for the <code>PFX</code></li>
<li>For vertical coils: <code>T</code> (Top), <code>B</code> (Bottom), <code>C</code> (<code>C</code> center)</li>
<li>For horizontal coils: <code>L</code> (Left), <code>R</code> (Right), <code>C</code> (<code>C</code> center)</li>
<li>For horizontal strips: <code>T</code> (Top), <code>B</code> (Bottom), <code>R1</code> (Row 1), etc&#x2026;</li>
<li>For vertical strips: <code>L</code> (Left), <code>R</code> (Right), <code>R1</code> (Column 1), etc&#x2026;</li>
<li>For blocks/sheets: <code>R1</code> (Row 1), <code>C1</code> (Column 1), etc&#x2026;</li>
</ul></li>
<li><code>pt_&lt;TAG&gt;_&lt;N&gt;</code>
<ul class="org-ul">
<li>For grill points set the <code>TAG</code> to <code>grill</code>.</li>
<li>For design coordinates use <code>d</code> or <code>design</code>.  For multiples use <code>design_&lt;SID&gt;</code> &#x2013; i.e. the design ROI for each stamp.</li>
<li>For imperf souvenir sheets use <code>edges</code></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-bb-hr-roi" class="outline-5">
<h5 id="bb-hr-roi"><span class="section-number-5">4.10.1.4.</span> About "<code>HR</code>" &amp; "<code>BB</code>" ROIs</h5>
<div class="outline-text-5" id="text-bb-hr-roi">
<ul class="org-ul">
<li>In image processing, a "bounding box" is the smallest rectangle with sides parallel to the image edges that contains some object</li>
<li>Most ROIs can be associated with a bounding box ROI with a "<code>BB</code>" in the name.</li>
<li>Most  "<code>BB</code>" ROIs are created by automatic computations (centering or grill measurements for example)</li>
<li>Examples:
<ul class="org-ul">
<li>"<code>designBB_top-frame</code>" is a bounding box associated with the design ROI "<code>design_top-frame</code>"</li>
<li>"<code>overlayBB_1</code>" is a bounding box associated with the design ROI "<code>overlay_1</code>"</li>
</ul></li>
<li><code>HR</code> ROIs are "Horizontal Reference" lines
<ul class="org-ul">
<li>In image processing, a "horizontal reference" is a line that indicates the natural horizontal of an artifact</li>
<li>These are not necessarily associated with another ROI, but they can be</li>
<li>Most <code>HR</code> ROIs are manually created by the end user instead of by automatic computations</li>
<li>Examples:
<ul class="org-ul">
<li>An text overprint might not be quite level.  If the overprint is identified by an ROI named "<code>overprint_UL-red</code>", then the horizontal reference ROI
would be named "<code>overprintHR_UL-red</code>".</li>
<li>Note that an associated ROI need not exist &#x2013; i.e. the "<code>overprint_UL-red</code>" ROI in the previous example isn't strictly necessary.</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org8613c0a" class="outline-5">
<h5 id="org8613c0a"><span class="section-number-5">4.10.1.5.</span> How ROIs are Used</h5>
<div class="outline-text-5" id="text-4-10-1-5">
<ul class="org-ul">
<li>Some macros will look in the ROI manager for specific ROI names or name patterns, and use them if they are found.
<ul class="org-ul">
<li><code>design[_&lt;SID&gt;][-&lt;SFX&gt;]</code>           - Design &amp; centering measurements</li>
<li><code>paper[_&lt;SID&gt;]</code>                    - Paper &amp; centering measurements</li>
<li><code>grill[_&lt;SID&gt;][-&lt;SFX&gt;]</code>            - Used to draw grill templates &amp; to measure a grill</li>
<li><code>grillPts[_&lt;SID&gt;][-&lt;SFX&gt;]</code>         - Used to draw grill templates &amp; to measure a grill</li>
<li><code>scale_&lt;X&gt;mm</code>                      - used to set image scale</li>
</ul></li>
<li>In addition, some ROIs will be <b>created</b> and added to the ROI manager if they are needed and don't already exist.
<ul class="org-ul">
<li><code>design</code>                           - Design &amp; centering measurements</li>
<li><code>paper</code>                            - Paper &amp; centering measurements</li>
<li><code>grill</code>                            - Used to draw grill templates &amp; to measure a grill</li>
<li><code>coilEdge&lt;B/L/R/T&gt;</code>                - Coil edge angle measurements</li>
</ul></li>
<li>Some macros will construct ROIs and save them in the ROI manager for the user.
<ul class="org-ul">
<li><code>designBB[_&lt;SID&gt;][-&lt;SFX&gt;]</code>         - Design bounding box created by a design measurement or centering report</li>
<li><code>paperBB[_&lt;SID&gt;]</code>                  - Paper bounding box created by a paper measurement or centering report</li>
<li><code>margin&lt;B/L/R/T&gt;[_&lt;SID&gt;][-&lt;SFX&gt;]</code>  - Rectangular selection for the margins (gap between a design &amp; a paper) created by the centering report</li>
<li><code>grill[_&lt;SID&gt;][-&lt;SFX&gt;]</code>            - Constructed from a <code>grillPts</code> ROI</li>
<li><code>scale_&lt;X&gt;mm</code>                      - Created by the scale ROI maker</li>
<li><code>pfLine&lt;NN&gt;_&lt;SFX&gt;</code>                 - The span of a perforated edge created by the dynamic perforation gauge</li>
<li><code>pfHol[&lt;NN&gt;&lt;MM&gt;_&lt;SFX&gt;</code>             - Marks a perforation hole created by the dynamic perforation gauge</li>
<li><code>philMeasured</code>                     - Last ROI measured by my the PhilaJ ROI measure function (<code>M</code> key)</li>
</ul></li>
<li>Some macros will construct ROIs, but <b>not</b> place them in the ROI manager
<ul class="org-ul">
<li><code>dynPf_&lt;NN&gt;_perfs</code>                 - Constructed by the dynamic perforation gauge when not using the ROI manager</li>
</ul></li>
<li>Some macros will use the current selection name &amp; update the ROI manager with the current selection:
<ul class="org-ul">
<li><code>design[_&lt;SID&gt;][-&lt;SFX&gt;]</code>           - Design &amp; centering measurements &#x2013; <code>centeringReport()</code> &amp; <code>measureDesign()</code></li>
<li><code>paper[_&lt;SID&gt;]</code>                    - Paper &amp; centering measurements &#x2013; <code>centeringReport()</code> &amp; <code>measurePaper()</code></li>
<li><code>grill[_&lt;SID&gt;][-&lt;SFX&gt;]</code>            - Used to draw grill templates &amp; to measure a grill</li>
<li><code>grillPts[_&lt;SID&gt;][-&lt;SFX&gt;]</code>         - Used to draw grill templates</li>
</ul></li>
<li>Some macros will use the current selection name &amp; extract extra data for computations
<ul class="org-ul">
<li><code>&lt;PFX&gt;_&lt;NN&gt;_perfs</code>                 - Used by <code>computePerfsFromDistance()</code> &amp; <code>drawDynPfOnLine()</code></li>
</ul></li>
<li>Some ROIs are not currently used by any macro
<ul class="org-ul">
<li><code>pf_&lt;SFX&gt;</code></li>
<li><code>fault_&lt;SFX&gt;</code></li>
<li><code>wmark_&lt;SFX&gt;</code></li>
<li><code>pn_&lt;N&gt;</code></li>
<li><code>idFact_&lt;SFX&gt;</code></li>
<li><code>pmark_&lt;SFX&gt;</code></li>
<li><code>overprint[BB/HL]_&lt;SID/SFX&gt;</code></li>
</ul></li>
</ul>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-rpi-tools" class="outline-2">
<h2 id="rpi-tools"><span class="section-number-2">5.</span> RPI Tools</h2>
<div class="outline-text-2" id="text-rpi-tools">
<p>
"<code>RPI_Tools</code>" is nothing more than a version of <code>"PhilaJ"</code> with an alternative, stripped down user interface that only exposes the 
<a href="https://richmit.github.io/microscope/leicaS8apo.html#rpi-camera">Raspberry Pi HQ microscope camera functionality</a>.
</p>

<p>
The remainder of this section documents the "<code>RPI_tools</code>" user interface.
</p>
</div>

<div id="outline-container-orga2cdaf9" class="outline-3">
<h3 id="orga2cdaf9"><span class="section-number-3">5.1.</span> Activate RPI-Tools</h3>
<div class="outline-text-3" id="text-5-1">

<div id="org6f710b7" class="figure">
<p><img src="RPI_Tools-toolsetmenu.gif" alt="RPI_Tools-toolsetmenu.gif" align="center" width="800" />
</p>
</div>

<p>
Once activated, it will add four buttons to the toolbar:
</p>


<div id="org9f8b454" class="figure">
<p><img src="RPI_Tools-toolsetbuttons.gif" alt="RPI_Tools-toolsetbuttons.gif" align="center" width="800" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgaf534e5" class="outline-3">
<h3 id="orgaf534e5"><span class="section-number-3">5.2.</span> Button Functions</h3>
<div class="outline-text-3" id="text-5-2">
</div>
<div id="outline-container-rpi-capture" class="outline-4">
<h4 id="rpi-capture"><span class="section-number-4">5.2.1.</span> Capture Image From RPI Microscope Camera</h4>
<div class="outline-text-4" id="text-rpi-capture">
<dl class="org-dl">
<dt><img src="RPI_Tools-toolsetbutton-capture.gif" alt="RPI_Tools-toolsetbutton-capture.gif" />  </dt><dd>Capture, save, and open an image from the camera.  Images are stored in the same location, and with the same file name conventions, used by <code>piSnap.sh</code>.</dd>
</dl>
</div>
</div>

<div id="outline-container-rpi-settings" class="outline-4">
<h4 id="rpi-settings"><span class="section-number-4">5.2.2.</span> Configure RPI Microscope Camera</h4>
<div class="outline-text-4" id="text-rpi-settings">
<dl class="org-dl">
<dt><img src="RPI_Tools-toolsetbutton-settings.gif" alt="RPI_Tools-toolsetbutton-settings.gif" /> </dt><dd>Change some configuration options</dd>
</dl>


<div id="orgec4034a" class="figure">
<p><img src="RPI_Tools-dialog-settings.gif" alt="RPI_Tools-dialog-settings.gif" align="center" width="400px" />
</p>
</div>

<ul class="org-ul">
<li>Specify a group for the captured image filenames.</li>
<li>Specify an annotation for the captured image filenames.</li>
<li>Set captured image format (jpg or png)</li>
<li>Set captured image scale (100% or 50%)</li>
<li>Set the scale factor for capture preview</li>
<li>Set the scale factor for the live video feed</li>
<li>Turn on/off asking for settings for each capture &#x2013; essentially pops up the settings dialog box everything the capture button is hit</li>
<li>Turn on/off repeated capture mode &#x2013; repeatedly captures images.  Most useful if a group is set.</li>
<li>Turn on/off live video preview before a capture.</li>
<li>Turn on/off loading images after capture.</li>
<li>Turn on/off running the set image scale tool after each capture if the image scale is not already set</li>
<li>Turn on/off debugging</li>
</ul>
</div>
</div>

<div id="outline-container-rpi-preview" class="outline-4">
<h4 id="rpi-preview"><span class="section-number-4">5.2.3.</span> Live Video From RPI Microscope Camera (no capture)</h4>
<div class="outline-text-4" id="text-rpi-preview">
<dl class="org-dl">
<dt><img src="RPI_Tools-toolsetbutton-video.gif" alt="RPI_Tools-toolsetbutton-video.gif" />     </dt><dd>Live video feed from camera.  Note the scale setting for the live video feed is different from the capture preview scale.</dd>
</dl>

<p>
If "Change Settings Before Capture" is set, then a simplified settings dialog box will appear before the video feed window.
</p>


<div id="org170052e" class="figure">
<p><img src="RPI_Tools-dialog-settings-v.gif" alt="RPI_Tools-dialog-settings-v.gif" align="center" width="400px" />
</p>
</div>
</div>
</div>

<div id="outline-container-rpi-load" class="outline-4">
<h4 id="rpi-load"><span class="section-number-4">5.2.4.</span> Load Previous RPI Microscope Camera Captures</h4>
<div class="outline-text-4" id="text-rpi-load">
<dl class="org-dl">
<dt><img src="RPI_Tools-toolsetbutton-load.gif" alt="RPI_Tools-toolsetbutton-load.gif" />     </dt><dd>Load previous capture(s) from camera using the ImageJ/Fiji macro above or the <code>piSnap.sh</code> script.</dd>
</dl>


<div id="org962a9ff" class="figure">
<p><img src="RPI_Tools-dialog-loadOld.gif" alt="RPI_Tools-dialog-loadOld.gif" align="center" width="400px" />
</p>
</div>
</div>
</div>

<div id="outline-container-scale-rpi" class="outline-4">
<h4 id="scale-rpi"><span class="section-number-4">5.2.5.</span> Set Scale for Stereo Microscope Photograph</h4>
<div class="outline-text-4" id="text-scale-rpi">
<dl class="org-dl">
<dt><img src="RPI_Tools-toolsetbutton-scale.gif" alt="RPI_Tools-toolsetbutton-scale.gif" />    </dt><dd>Set image scale based upon microscope settings.  This script contains hardwired settings for my specific microscope and lenses, and may require modification for your microscope.

<ul class="org-ul">
<li>The choice of microscope enables a calibration correction factor in the final computation</li>
<li>The "Adjust for Resolution" option adjusts the scale if the number of horizontal pixels in the image differs from the horizontal resolution of the
sensor.  Most commonly this use used when the sensor is used in 2x2 mode yielding smaller image.  This option also works if the image is resized after
the fact.</li>
</ul></dd>
</dl>


<div id="orgc74c853" class="figure">
<p><img src="RPI_Tools-dialog-setscale.gif" alt="RPI_Tools-dialog-setscale.gif" align="center" width="400px" />
</p>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-orgdae6206" class="outline-2">
<h2 id="orgdae6206"><span class="section-number-2">6.</span> EOF</h2>
<div class="outline-text-2" id="text-6">
<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />
<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />
<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />
<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />
<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />
</div>
</div>
</div>
<div id="postamble" class="status">
Created by Mitch Richling <<a href="mailto:http://www.mitchr.me/">http://www.mitchr.me/</a>>.  Rendered on 2022-04-23 Sat 09:54 via <a href="https://www.gnu.org/software/emacs/">Emacs</a> 28.1 (<a href="https://orgmode.org">Org</a> mode 9.5.2)
</div>
</body>
</html>
